<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Easter&#39;s blog</title>
  
  <subtitle>数据分析</subtitle>
  <link href="http://yoursite.com/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2025-12-19T01:27:25.940Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>warren</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>读书笔记-代码整洁之道（程序员的职业素养）</title>
    <link href="http://yoursite.com/2025/12/12/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93-1%EF%BC%88%E4%B8%93%E4%B8%9A%E4%B8%BB%E4%B9%89%EF%BC%89/"/>
    <id>http://yoursite.com/2025/12/12/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93-1%EF%BC%88%E4%B8%93%E4%B8%9A%E4%B8%BB%E4%B9%89%EF%BC%89/</id>
    <published>2025-12-12T06:35:57.000Z</published>
    <updated>2025-12-19T01:27:25.940Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>代码整洁之道（程序员的职业素养）是每个程序员必读的一本书，这本书虽然没有讲关于编码方式（在子妹篇，代码整洁之道里有写）的内容，但是就职业素养，也就是专业的程序员应该如何做事方面，作者结合自己的的工作经历，给出了一些见解，值得我们学习。</p></blockquote><span id="more"></span><h1 id="专业主义"><a href="#专业主义" class="headerlink" title="专业主义"></a>专业主义</h1><p>成为一个优秀的人应该拥有的品质</p><ul><li>担当责任</li><li>不行损坏之事<ul><li>不破坏软件功能</li><li>不要破坏结构</li></ul></li><li>职业道德<ul><li>了解自己所处的领域</li><li>坚持学习</li><li>练习</li><li>合作</li><li>辅导</li><li>了解业务领域</li><li>与雇主/客户保持一致</li><li>谦逊<br>\</li></ul></li></ul><h1 id="说“不”"><a href="#说“不”" class="headerlink" title="说“不”"></a>说“不”</h1><blockquote><p>能就是能，不能就是不能，不要说“试试看”</p></blockquote><h2 id="对抗角色"><a href="#对抗角色" class="headerlink" title="对抗角色"></a>对抗角色</h2><p>面对不合理deadline，不要说，“试试看”，因为上级会讲“试试看”理解成“好的，没问题”。如果上级听到了”试试看”这类的话，也应该进行进一步确认，确认这个“试试看”是不是能够确信能在规定时间内解决问题。</p><p>正确的做法是，达成最佳的可能结果，双方各表异议相互说“不”，然后找到双方都能接受的解决方案。工作中不可能避免任何冲突，完全详细也不见得是好事。</p><h2 id="高风险时刻"><a href="#高风险时刻" class="headerlink" title="高风险时刻"></a>高风险时刻</h2><p>越是高风险时刻，越要把自己已经的信息和风险暴露出来，然后重新评估预期，当然，作为上级，同样也要在知悉新的预估结果时，向业务方说明情况，而不是拖的更久。</p><h2 id="要有团队精神"><a href="#要有团队精神" class="headerlink" title="要有团队精神"></a>要有团队精神</h2><p>作为小组长，应该倾听员工的合理要求，比如，员工明确说明，哪些是能做到的，哪些是做不到的，小组长应该和员工站在一起，向上明确说“不”。</p><h2 id="不要说“试试看”"><a href="#不要说“试试看”" class="headerlink" title="不要说“试试看”"></a>不要说“试试看”</h2><p>“试试看”，意味着承认之前没有竭尽全力，只要在加把劲还是可以达成目标的，因此许诺“尝试”，实际上是在承诺确保成功，压力就需要你来抗了。如果没有达到预期的效果，那么就表示你失败了。所以，在关键时刻，不要说“试试看”。实际上，在这种情况下，领导需要降低自己预期，并且向上反馈风险。</p><h2 id="消极对抗"><a href="#消极对抗" class="headerlink" title="消极对抗"></a>消极对抗</h2><p>假设员工的预估结果，小组长没有告知上级，而员工仍按照自己的计划推进，那么这就是消极对抗，正确的做法是员工应该直接和上级沟通，来阻止灾难的发生。</p><h1 id="说“是“"><a href="#说“是“" class="headerlink" title="说“是“"></a>说“是“</h1><h2 id="承诺用语"><a href="#承诺用语" class="headerlink" title="承诺用语"></a>承诺用语</h2><p>做出承诺，包含三个步骤</p><ul><li>口头上说自己会去做</li><li>心里认真对待做出的承诺</li><li>真正付诸行动<h2 id="识别”缺乏承诺“的征兆"><a href="#识别”缺乏承诺“的征兆" class="headerlink" title="识别”缺乏承诺“的征兆"></a>识别”缺乏承诺“的征兆</h2>包含以下几个用词和短语的，会表明”缺乏承诺“，需要注意</li><li>需要/应当</li><li>希望/但愿</li><li>让我们<h2 id="真正的承诺听起来是什么样子的"><a href="#真正的承诺听起来是什么样子的" class="headerlink" title="真正的承诺听起来是什么样子的"></a>真正的承诺听起来是什么样子的</h2>我将在…之前…<br>对自己将会做某件事做了清晰的事实陈述。需要为自己做出的承诺付出责任。但是就算给出承诺，也会有完成不了的时候，可能是依赖别人，也可能是有一些点没有考虑到，也可能是不太确信自己是否真的能完成<h3 id="依赖别人"><a href="#依赖别人" class="headerlink" title="依赖别人"></a>依赖别人</h3>采取行动，和依赖的人进行沟通<h3 id="为考虑周全"><a href="#为考虑周全" class="headerlink" title="为考虑周全"></a>为考虑周全</h3>重新调整别人是你的预期，越快越好<h3 id="不太确定自己是否能完成"><a href="#不太确定自己是否能完成" class="headerlink" title="不太确定自己是否能完成"></a>不太确定自己是否能完成</h3>全力前进，离目标更近，当然也要提前告知风险</li></ul><p><strong>做出承诺或许让人听着很害怕，但是如果一直信守承诺，热家会认为你是一个靠谱的人</strong></p><p>不需要对所有请求都回答“是”，不过，应该努力寻找解决问题的方案，尽可能做到有求必应。</p><h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><p>这章标题虽然叫编码，但是作者讲的是编码时的心理，精神和情绪。</p><ul><li>如果感到疲劳或者心烦意乱，千万不要编码</li><li>编码时候避免进入流态区，因为进入流态区往往会无法顾及全局。</li></ul><h1 id="测试驱动开发"><a href="#测试驱动开发" class="headerlink" title="测试驱动开发"></a>测试驱动开发</h1><h2 id="TDD三大法则"><a href="#TDD三大法则" class="headerlink" title="TDD三大法则"></a>TDD三大法则</h2><ol><li>在编好失败单元测试之前，不要编写任何产品代码。</li><li>只要有一个单元测试失败了，就不要再写测试代码。</li><li>产品代码恰好能让当前失败的单元测试成功通过即可，不要多写。<br>这个循环不断反复，写一些测试代码，写一些产品代码。两套代码同步增长，互为补充。<h2 id="TDD的优势"><a href="#TDD的优势" class="headerlink" title="TDD的优势"></a>TDD的优势</h2><h3 id="确定性"><a href="#确定性" class="headerlink" title="确定性"></a>确定性</h3>如果测试用力全部通过，就可以确信代码可以交付<h3 id="缺陷注入率"><a href="#缺陷注入率" class="headerlink" title="缺陷注入率"></a>缺陷注入率</h3>TDD可以显著降低缺陷<h3 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h3>如果不写单元测试，有可能出现各个函数耦合在一起，最终无法写单元测试，因此遵循TDD法则，能够驱动开发者做出松耦合的设计。</li></ol><h2 id="TDD的局限性"><a href="#TDD的局限性" class="headerlink" title="TDD的局限性"></a>TDD的局限性</h2><p>遵循TDD法则也不能保证一定能保证带来上述好处，即使先写单元测试，还是有可能写出糟糕的代码。</p><h1 id="验收测试"><a href="#验收测试" class="headerlink" title="验收测试"></a>验收测试</h1><p>在我们实际的开发过程中，总会遇到这两个问题</p><p>写代码的人总是希望很早就精确最后要交付什么，因为需要对整个系统进行评估，但是，需求总是变化的，所以评估需要基于不那么精确的需求。</p><p>业务方看到真实的运行情况，也可能会改变自己的想法，这种现象叫观察者效应，每次向业务方展示一项功能，业务方就获得了比之前更多的信息，这些信息反过来又影响到他们对整个系统的看法。</p><p>但是如果避免过早精细化，又会导致迟来的模糊性，对最后交付的东西含糊不清</p><p>本章验收测试的定义为业务方与开发方合作编写的测试，其目的在于确定需求已经完成。</p><p>开发方，业务方，测试方对验收测试达成共识，大家都清楚系统的行为是什么样子。</p><p>验收测试应该进行自动化。</p><p>验收测试不是单元测试，单元测试是程序员写给程序员的，是正式的设计文档，描述代码行为。关心单元测试的是程序员。</p><p>验收测试是业务方写给业务方的，是正式的需求文档，描述了业务方认为系统应该如何运行。关系验收测试的是也无妨和程序员。</p><h1 id="测试策略"><a href="#测试策略" class="headerlink" title="测试策略"></a>测试策略</h1><p>测试并不是写一些单元测试或者验收测试那么简单。编写这些测试可能只是万里长征的第一步。每个专业的开发团队都需要有一套好的测试策略</p><h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>程序员编写，保证代码是正确的</p><h2 id="组件测试"><a href="#组件测试" class="headerlink" title="组件测试"></a>组件测试</h2><p>组件测试是验收测试的一种，针对系统各个组件编写</p><p>组件测试由QA和业务人员编写，开发人员提供辅助。</p><h2 id="集成测试"><a href="#集成测试" class="headerlink" title="集成测试"></a>集成测试</h2><p>测试将组件装配成组，测试组件之间是否能够正常通信。</p><p>集成测试是编排性测试，不会测试业务规则，而是主要测试组件装配在一起是否能够正常连接，正常通信。集成测试一般由系统架构师或主设计师来写。</p><h2 id="系统测试"><a href="#系统测试" class="headerlink" title="系统测试"></a>系统测试</h2><p>系统测试是针对整个集成完毕的系统进行自动化测试，是最终的集成测试，不会直接测试业务规则，而是测试系统是否已经正确组装完毕，以及系统各个组件之间是否能正确交互，同时应该包含吞吐率测试和性能测试</p><p>系统测试一般由系统架构师和技术负责人编写。</p><h2 id="人工探索式测试"><a href="#人工探索式测试" class="headerlink" title="人工探索式测试"></a>人工探索式测试</h2><p>需要人工介入，这些测试的意图是，探索系统预期以外的行为，需要使用人类的创新能力。</p><h1 id="时间管理"><a href="#时间管理" class="headerlink" title="时间管理"></a>时间管理</h1><p>工作中高校管理时间</p><h2 id="会议"><a href="#会议" class="headerlink" title="会议"></a>会议</h2><p>开发者应该清楚会议的高昂成本，同时清楚自己的时间是宝贵的<br>关于会议，有两条真理</p><ul><li>会议是必须的</li><li>会议浪费了大量的时间</li></ul><h3 id="拒绝会议"><a href="#拒绝会议" class="headerlink" title="拒绝会议"></a>拒绝会议</h3><p>邀请你参加会议的人不负责管理你的时间，为时间负责的只有你，所以，如果你收到会议邀请，无比确保出席会议可以给自己目前的工作带来切实且显著的成效，否则不必参加</p><h3 id="离席"><a href="#离席" class="headerlink" title="离席"></a>离席</h3><p>如果发现参加某个会议是浪费时间，应该想个办法礼貌的退出来</p><h3 id="确定议程与目标"><a href="#确定议程与目标" class="headerlink" title="确定议程与目标"></a>确定议程与目标</h3><p>如果收到会议邀请，无比弄清楚指定的议题是什么，每个议题多长时间，要取得什么成果，如果没有确切的答案，可以礼貌拒绝</p><h3 id="例会"><a href="#例会" class="headerlink" title="例会"></a>例会</h3><p>到场时依次回答三个问题</p><ul><li>我昨天干了什么</li><li>我今天打算干什么</li><li>遇到了什么问题</li></ul><p>每个人的回答时间不应该超过20s，所以每个人的发言不应该超过1min。</p><h3 id="迭代计划会议"><a href="#迭代计划会议" class="headerlink" title="迭代计划会议"></a>迭代计划会议</h3><p>迭代计划会议用来选择下一轮迭代中实现的开发任务，在会议召开之前必须完成两项任务：评估可选择任务的开发时间，确定这些任务的业务价值。会议节奏应该足够快，简明扼要讨论各个候选任务，决定选择还是放弃，在每个任务上花的时间应该限制在5-10分钟，如果需要更详细的讨论，则应当另选时间，挑出团队中的一部分人专门进行。</p><h3 id="迭代回顾和DEMO展示"><a href="#迭代回顾和DEMO展示" class="headerlink" title="迭代回顾和DEMO展示"></a>迭代回顾和DEMO展示</h3><p>在迭代末尾召开，团队成员讨论什么做得对，什么做的不对，业务方可以看到最新成果的demo。只会牵涉到最近一两周的工作。</p><h3 id="争论-反对"><a href="#争论-反对" class="headerlink" title="争论/反对"></a>争论/反对</h3><p>凡事不能在5分钟内解决的争论，都不能靠辩论解决，需要用数据说话。<br>如果争论必须解决，应当要求争论各方在5分钟内向大家摆明问题，然后大家投票。</p><h2 id="注意力点数"><a href="#注意力点数" class="headerlink" title="注意力点数"></a>注意力点数</h2><p>每个人都有固定点数的注意力，注意力集中的时候会消耗注意力点数，不集中的时候则会恢复。</p><p>如果保持良好的注意力点数</p><ul><li>睡眠</li><li>咖啡因</li><li>恢复</li><li>肌肉注意力（可以提升心智注意力）</li><li>输入与输出（接触其他人的创造性思维）</li></ul><h2 id="时间拆分和番茄工作法"><a href="#时间拆分和番茄工作法" class="headerlink" title="时间拆分和番茄工作法"></a>时间拆分和番茄工作法</h2><p>把时间分为番茄时间和非番茄时间，番茄时间是有生产率的，可以真正做点事情，非番茄时间可以处理一些非工作适宜，例如，休息，参加会议等。</p><p>如果工作中陷入死胡同或者泥潭，应该及时发现和修正。</p><h1 id="预估"><a href="#预估" class="headerlink" title="预估"></a>预估</h1><p>作者给出了预估的几种方法</p><h2 id="PERT"><a href="#PERT" class="headerlink" title="PERT"></a>PERT</h2><ul><li>O: 乐观估计，如果一切进行顺利，可以在这个时间点完成</li><li>N：标称估计，这是概率最大的完成时间点</li><li>P: 悲观估计，这是最糟糕的数字</li></ul><p>有了以上三个预估，我们可以像下面这样描述概率分布<br><code>u = (O + 4N + P) / 6</code><br>u是任务的期望完成时间</p><p><code>a = (P - O) / 6</code><br>a是这个任务概率分布的标准差，用来衡量不确定性，如果这个数字很大，就表示非常不确定<br>假设O=1, N=3, P=12,则u = 4.2, a = 1.8<br>那么任务的预估天数是(4.2, 1.8),有可能会5天完成，也可能6天甚至9天。</p><p>如果同时有多个任务，那么总的期望完成时间就是这些任务的期望完成时间的综合<br>假如有三项任务，预估分别是（4.2，1.8），（3.5，22），（6.5， 1.3）</p><p>那么这三项任务的期望完成时间是14天<br><code>4.2 + 3.5 + 6.5 = 14.2</code></p><p>总的标准差就是各个任务的标准差平方之和的平方根，也就是<br><code>√（1.8^ + 2.2^ + 1.3^） ～ 3.13</code></p><p>所以，任务大概需要14天完成，也可能需要17天（1a）,也可能是2a(20)天，也可能更长时间，，不过概率很小。</p><h2 id="预估任务"><a href="#预估任务" class="headerlink" title="预估任务"></a>预估任务</h2><h3 id="德尔菲法"><a href="#德尔菲法" class="headerlink" title="德尔菲法"></a>德尔菲法</h3><p>一群人集合起来，讨论某项任务，预估完成时间，然后重复 ”讨论-预估“</p><ul><li>亮手指（同时亮手指，来）</li><li>规划扑克（可以对纸牌设置合理的点数，可以是斐波那契数列，或者其他点数。）</li><li>关联估计（一群人对任务卡片排序，觉得需要时间长的放在右边，短的在左边，任何人都能随意更换卡片顺序，然后拿更换顺序次数最多的拿出来讨论）</li></ul><h3 id="大数定律"><a href="#大数定律" class="headerlink" title="大数定律"></a>大数定律</h3><p>将大任务拆分成小任务，分开预估再汇总。</p><h1 id="压力"><a href="#压力" class="headerlink" title="压力"></a>压力</h1><h2 id="避免压力"><a href="#避免压力" class="headerlink" title="避免压力"></a>避免压力</h2><h3 id="承诺"><a href="#承诺" class="headerlink" title="承诺"></a>承诺</h3><p>避免对没有把握达成的最后期限做出承诺，如果有人代我们做出承诺，出于责任感，我们必须主动找到方法来兑现承诺，但是一定不要接受这些承诺</p><h3 id="保持整洁"><a href="#保持整洁" class="headerlink" title="保持整洁"></a>保持整洁</h3><p>让系统，代码和设计尽可能整洁，可以避免压力，不要容忍混乱，混乱会降低速。</p><h3 id="危机中的纪律"><a href="#危机中的纪律" class="headerlink" title="危机中的纪律"></a>危机中的纪律</h3><p>选择那些在危机时刻依然会遵守的纪律原则（如果在危机时刻就不遵守了，就代表你不相信这些原则），比如TDD，保持代码整洁，结对工作…</p><p>如果你遵守的纪律原则是工作的最佳方式，那么即使在危机时刻，也要坚决秉持这些纪律原则</p><h2 id="应对压力"><a href="#应对压力" class="headerlink" title="应对压力"></a>应对压力</h2><ul><li>不要惊慌（努力找到最好的结果）</li><li>沟通（让你所在的团队和领导知道你所处的困境，寻求帮助和指引）</li><li>依靠纪律原则</li><li>寻求帮助（结对编程）</li></ul><h1 id="协作"><a href="#协作" class="headerlink" title="协作"></a>协作</h1><p>本章将的内容主要是作者分享了一些经历，然后讲出自己的一些想法</p><ol><li><p>代码归属团体<br>不要设置代码壁垒，不要阻止别人修改你的代码，而是尽可能多的相互合作，通过合作来达到学习的目的</p></li><li><p>结对<br>结对工作可以分享知识，通过相互结对来学习系统的不同部分和业务，尽管每位成员都有自己的位置，但是在紧要关头，每位成员也要能接替别人的位置。<br>结对是复查代码最好的方式，系统中不应该包含未经其他程序员复查过的代码，最有效最简单的代码复查方法，就是以互相协作的方式完成代码编写。</p></li></ol><p>如果我们真想众生能以变成度日，那么一定要学会交流。</p><h1 id="团队与项目"><a href="#团队与项目" class="headerlink" title="团队与项目"></a>团队与项目</h1><p>这是章节讲述的是团队和项目哪个优先，是组建一只有凝聚力的团队，把项目分配给团队，还是根据不同的项目，拉起不同团队更优，最后的结论是，团队比项目更难构建，组件一支稳健的团队，让团队在一个又一个项目中整体移动共同工作是较好的做法。</p><h1 id="辅导、学徒期与技艺"><a href="#辅导、学徒期与技艺" class="headerlink" title="辅导、学徒期与技艺"></a>辅导、学徒期与技艺</h1><p>很多刚毕业的大学生完全无法满足工作中的需要，因此需要有技艺的人进行辅导。<br>在这个章节中，作者以自己的两段经历开头，引出自己没有接受过常规辅导，没有一位老师对他建立起正确的价值观和反思内省的习惯，导致他失去了工作，意在指出辅导的重要性。</p><p>随后指出软件专业人士如何将刚毕业的年轻人提升到专业水准上，应该由实习生-熟练工-大师，循序渐进。</p><p><strong>技艺</strong><br>技艺是可通过“模仿”来复制</p><p>技艺包含价值观、原则、技术、态度和正见。</p><p>技艺如何获取，技艺由口口相传和手手相承而来，需要由自身人士向年轻学徒殷勤传授，然后在学徒间相互传播。</p><p>技艺只要可以被人观察到，它就具有传染性。</p><p>如果想传授技艺，首先自己要成为表率，首先自己要成为能工巧匠，展示自己的技艺，然后，将剩余事情交给技艺模因的自然之道。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;代码整洁之道（程序员的职业素养）是每个程序员必读的一本书，这本书虽然没有讲关于编码方式（在子妹篇，代码整洁之道里有写）的内容，但是就职业素养，也就是专业的程序员应该如何做事方面，作者结合自己的的工作经历，给出了一些见解，值得我们学习。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="读书笔记" scheme="http://yoursite.com/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="代码整洁之道" scheme="http://yoursite.com/tags/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/"/>
    
  </entry>
  
  <entry>
    <title>kubesphere搭建流程</title>
    <link href="http://yoursite.com/2023/03/21/kubesphere%E6%90%AD%E5%BB%BA%E6%B5%81%E7%A8%8B/"/>
    <id>http://yoursite.com/2023/03/21/kubesphere%E6%90%AD%E5%BB%BA%E6%B5%81%E7%A8%8B/</id>
    <published>2023-03-21T06:35:57.000Z</published>
    <updated>2023-03-21T07:23:27.766Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>KubeSphere是在Kubernetes之上构建的以应用为中心的企业级分布式容器平台，提供简单易用的操作界面以及向导式操作方式。</p></blockquote><span id="more"></span><h2 id="前提："><a href="#前提：" class="headerlink" title="前提："></a>前提：</h2><ul><li>一个私有的镜像仓库</li><li>一个k8s部署环境 <h3 id="搭建一个私有的镜像仓库"><a href="#搭建一个私有的镜像仓库" class="headerlink" title="搭建一个私有的镜像仓库"></a>搭建一个私有的镜像仓库</h3></li></ul><ol><li><p>创建证书放置目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p certs</span><br></pre></td></tr></table></figure></li><li><p>生成证书，在字段 <code>Common Name</code> 中需要提供一个域名。例如，本示例中该字段被指定为 <code>dockerhub.kubekey.local</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl req \</span><br><span class="line">-newkey rsa:4096 -nodes -sha256 -keyout certs/domain.key \</span><br><span class="line">-x509 -days 36500 -out certs/domain.crt</span><br></pre></td></tr></table></figure><p>![[Pasted image 20230320142545.png]]</p></li><li><p>启动<code>docker</code>容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --restart=always \</span><br><span class="line">  --name registry \</span><br><span class="line">  -v &quot;$(pwd)&quot;/certs:/certs \</span><br><span class="line">  -v /mnt/registry:/var/lib/registry \</span><br><span class="line">  -e REGISTRY_HTTP_ADDR=0.0.0.0:443 \</span><br><span class="line">  -e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt \</span><br><span class="line">  -e REGISTRY_HTTP_TLS_KEY=/certs/domain.key \</span><br><span class="line">  -p 443:443 \</span><br><span class="line">  registry:2</span><br></pre></td></tr></table></figure></li></ol><p><em>Docker 使用 <code>/var/lib/docker</code> 作为默认路径来存储所有 Docker 相关文件（包括镜像）。建议您添加附加存储卷，分别给 <code>/var/lib/docker</code> 和 <code>/mnt/registry</code> 挂载至少 <strong>100G</strong>。</em></p><ol start="4"><li>配置仓库<br>在<code>/etc/hosts</code>文件中将主机名映射到机器的私有ip地址<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*.*.*.* dockerhub.kubekey.local</span><br></pre></td></tr></table></figure>复制证书到指定目录，并使 Docker 信任该证书<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/docker/certs.d/dockerhub.kubekey.local</span><br><span class="line">cp certs/domain.crt /etc/docker/certs.d/dockerhub.kubekey.local/ca.crt</span><br></pre></td></tr></table></figure>要验证私有证书是否有效，可以先复制一个证书到本地，然后使用<code>docker push</code>和<code>docker pull</code>命令来测试</li></ol><h3 id="搭建k8s部署环境（此处为单节点）"><a href="#搭建k8s部署环境（此处为单节点）" class="headerlink" title="搭建k8s部署环境（此处为单节点）"></a>搭建k8s部署环境（此处为单节点）</h3><h4 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h4><ol><li>环境准备</li></ol><ul><li>关闭防火墙 <code>systemctl stop firewalld</code></li><li>关闭<code>selinux</code> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/enforcing/disabled/&#x27; /etc/config/selinux</span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure></li><li>关闭<code>swap</code>：<code>swapoff -a</code></li></ul><ol start="2"><li>设置系统主机名<br><code>hostnamectl set-hostname master</code></li><li>设置各机器的<code>/etc/hosts</code><br><code>*.*.*.* master</code></li><li>安装K8s软件包</li><li>创建<code>/etc/sysctl.d/k8s.conf</code>文件，添加以下内容<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.ipv4.ip_forward = 1</span><br></pre></td></tr></table></figure>执行以下命令使其生效<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modprobe br_netfilter</span><br><span class="line">sysctl -p /etc/sysctl.d/k8s.conf</span><br></pre></td></tr></table></figure></li><li>开启IP转发功能<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward</span><br></pre></td></tr></table></figure>修改文件<code>daemon.json</code><br>设定<code>cgroup=systemd：</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]</span><br></pre></td></tr></table></figure>修改后执行：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker.service</span><br></pre></td></tr></table></figure></li><li>设置docker和kubelet开机启动：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker</span><br><span class="line">systemctl enable --now  kubelet.service</span><br></pre></td></tr></table></figure></li></ol><h4 id="初始化集群"><a href="#初始化集群" class="headerlink" title="初始化集群"></a>初始化集群</h4><ol><li>生成初版配置文件：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm config print init-defaults &gt; kubeadm-init.yaml</span><br></pre></td></tr></table></figure>将 <code>advertiseAddress: 1.2.3.4</code> 修改为本机地址。</li></ol><p>在<code>serviceSubnet</code>上加一行<code>podSubnet:10.244.0.0/16</code></p><p>将 <code>imageRepository: k8s.gcr.io</code> 修改为<code>imageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers</code>（非必须）</p><p>修改<code>/etc/systemd/system/kubelet.service.d/kubeadm.conf</code>文件</p><p>添加：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--cgroup-driver=systemd</span><br><span class="line">--cni-bin-dir=/usr/libexec/cni</span><br><span class="line">--node-ip=环境ip</span><br><span class="line">--hostname-override=master</span><br><span class="line">--fail-swap-on=false</span><br></pre></td></tr></table></figure><ol start="2"><li>查看kubeadm配置后所需镜像版本：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm config images list --config kubeadm-init.yaml</span><br></pre></td></tr></table></figure></li><li>拉取镜像<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm config images pull --config kubeadm-init.yaml</span><br></pre></td></tr></table></figure></li><li>执行初始化<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm init --config kubeadm-init.yaml</span><br></pre></td></tr></table></figure></li><li>根据生成的日志在master执行如下命令：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">chown \$(id -u):\$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure></li><li>修改<code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code><br>添加：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- --allocate-node-cidrs=true</span><br><span class="line"></span><br><span class="line">- --cluster-cidr=10.244.0.0/16</span><br><span class="line"></span><br><span class="line">- --service-cluster-ip-range=10.96.0.0/12</span><br></pre></td></tr></table></figure></li><li>下载<code>flannel</code>配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br><span class="line">kubectl apply -f kube-flannel.yml</span><br></pre></td></tr></table></figure></li><li>查看所有<code>pod</code>状态，是否全部<code>running</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -A</span><br></pre></td></tr></table></figure></li><li>去污点<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes master node-role.kubernetes.io/master:NoSchedule-</span><br></pre></td></tr></table></figure></li><li>功能测试</li></ol><ul><li>新建namespace<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create ns hello</span><br></pre></td></tr></table></figure><h2 id="准备部署kubesphere需要的镜像"><a href="#准备部署kubesphere需要的镜像" class="headerlink" title="准备部署kubesphere需要的镜像"></a>准备部署kubesphere需要的镜像</h2></li></ul><p><strong>下载镜像列表</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`curl -L -O https://github.com/kubesphere/ks-installer/releases/download/v3.3.1/images-list.txt`</span><br></pre></td></tr></table></figure><p><strong>下载离线安装脚本并添加执行权限</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">offline-installation-tool.sh</span><br><span class="line">chmod +x offline-installation-tool.sh</span><br></pre></td></tr></table></figure><p><strong>拉取镜像</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./offline-installation-tool.sh -s -l images-list.txt -d ./kubesphere-images`</span><br></pre></td></tr></table></figure><p><strong>将镜像推送到私有仓库</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./offline-installation-tool.sh -l images-list.txt -d ./kubesphere-images -r dockerhub.kubekey.local`</span><br></pre></td></tr></table></figure><h2 id="下载部署文件"><a href="#下载部署文件" class="headerlink" title="下载部署文件"></a>下载部署文件</h2><p><strong>下载下面两个文件</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L -O https://github.com/kubesphere/ks-installer/releases/download/v3.3.1/cluster-configuration.yaml</span><br><span class="line">curl -L -O https://github.com/kubesphere/ks-installer/releases/download/v3.3.1/kubesphere-installer.yaml</span><br></pre></td></tr></table></figure><p><strong>编辑 <code>cluster-configuration.yaml</code> 添加您的私有镜像仓库。例如，本教程中的仓库地址是 <code>dockerhub.kubekey.local</code>，将它用作 <code>.spec.local_registry</code> 的值，如下所示：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spec:</span><br><span class="line">  persistence:</span><br><span class="line">    storageClass: &quot;&quot;</span><br><span class="line">  authentication:</span><br><span class="line">    jwtSecret: &quot;&quot;</span><br><span class="line">  local_registry: dockerhub.kubekey.local # Add this line manually; make sure you use your own registry address.</span><br></pre></td></tr></table></figure><p><strong>修改kubesphere-installer.yaml，将ks-install替换为自己的仓库地址</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &quot;s#^\s*image: kubesphere.*/ks-installer:.*#        image: dockerhub.kubekey.local/kubesphere/ks-installer:v3.0.0#&quot; kubesphere-installer.yaml</span><br></pre></td></tr></table></figure><h2 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f kubesphere-installer.yaml</span><br><span class="line">kubectl apply -f cluster-configuration.yaml</span><br></pre></td></tr></table></figure><h2 id="结束安装后可以查看pod日志查看是否部署成功，出现如下内容则部署成功"><a href="#结束安装后可以查看pod日志查看是否部署成功，出现如下内容则部署成功" class="headerlink" title="结束安装后可以查看pod日志查看是否部署成功，出现如下内容则部署成功"></a>结束安装后可以查看pod日志查看是否部署成功，出现如下内容则部署成功</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#####################################################</span><br><span class="line"></span><br><span class="line">###              Welcome to KubeSphere!           ###</span><br><span class="line"></span><br><span class="line">#####################################################</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Console: http://192.168.0.2:30880</span><br><span class="line">Account: admin</span><br><span class="line">Password: P@88w0rd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NOTES：</span><br><span class="line">  1. After logging into the console, please check the</span><br><span class="line">     monitoring status of service components in</span><br><span class="line">     the &quot;Cluster Management&quot;. If any service is not</span><br><span class="line">     ready, please wait patiently until all components</span><br><span class="line">     are ready.</span><br><span class="line">  2. Please modify the default password after login.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#####################################################</span><br><span class="line">https://kubesphere.io             20xx-xx-xx xx:xx:xx</span><br><span class="line">#####################################################</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="访问控制台"><a href="#访问控制台" class="headerlink" title="访问控制台"></a>访问控制台</h2><p>通过<code>http://&#123;IP&#125;:30880</code>访问控制台，默认账号密码admin/P@88w0rd访问kubesphere的默认控制台。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;KubeSphere是在Kubernetes之上构建的以应用为中心的企业级分布式容器平台，提供简单易用的操作界面以及向导式操作方式。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="部署" scheme="http://yoursite.com/categories/%E9%83%A8%E7%BD%B2/"/>
    
    
    <category term="kubesphere" scheme="http://yoursite.com/tags/kubesphere/"/>
    
    <category term="k8s" scheme="http://yoursite.com/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>linux给root文件系统扩容的两种方法</title>
    <link href="http://yoursite.com/2023/03/17/linux%E7%BB%99root%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%89%A9%E5%AE%B9%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95/"/>
    <id>http://yoursite.com/2023/03/17/linux%E7%BB%99root%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%89%A9%E5%AE%B9%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95/</id>
    <published>2023-03-17T01:41:29.000Z</published>
    <updated>2023-03-17T02:58:18.881Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>在linux系统使用上，可能会遇到No space left的情况，这里说明如何通过压缩<code>home</code>分区和给添加磁盘给<code>root</code>目录扩容来解决。</p></blockquote><span id="more"></span><h4 id="问题场景"><a href="#问题场景" class="headerlink" title="问题场景"></a>问题场景</h4><p>在<code>linux</code>根目录存储文件时，如果<code>root</code>文件系统空间不够，就会导致如下错误，这里我们提供两种思路来解决。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error ... : no space left on device</span><br></pre></td></tr></table></figure><h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><h5 id="压缩home分区，剩余空间给root分区"><a href="#压缩home分区，剩余空间给root分区" class="headerlink" title="压缩home分区，剩余空间给root分区"></a>压缩<code>home</code>分区，剩余空间给root分区</h5><p><strong>步骤</strong></p><ol><li>卸载<code>home</code>分区，卸载<code>home</code>分区一定要备份<code>/home</code>目录的业务数据</li><li>卸载时，如果提示设备忙，使用<code>fuser -m /home</code>查看谁在使用这个<code>/home</code>分区，如果提示没有<code>fuser</code>命令需要安装，<code>yum install pamisc</code></li><li>停止进程，或者使用<code>killall -9</code></li><li>卸载<code>/home</code>目录 <code>umount /home/</code></li><li><code>df -h</code>查看是否卸载成功</li><li>压缩分区</li><li><code>resize2fs -p /dev/mapper/centos-home 15G</code><br>确认是<code>xfs</code>格式系统：<br><code>cat /etc/fstab/grep centos-home</code><br><code>xfs</code>文件系统扩容必须安装<code>xfsdump</code>工具，<code>yum install xfsdump</code></li><li>减少<code>home</code>空间到<code>15G</code>，增大目录<br><code>lvreduce -L 15G /dev/mapper/centos-home</code></li><li>重新挂载<code>/home</code>  <code>mount /home</code><br>必须格式化/home分区，才能挂载，所以缩减<code>/home</code>之前必须备份<code>/home</code>的内容<br><code>mkfs.xfs -f /dev/mapper/centos-home</code><br>再重新挂载<code>mount /home</code></li></ol><h4 id="通过新挂载磁盘来给根目录扩容"><a href="#通过新挂载磁盘来给根目录扩容" class="headerlink" title="通过新挂载磁盘来给根目录扩容"></a>通过新挂载磁盘来给根目录扩容</h4><p><strong>步骤</strong></p><ol><li>新添加磁盘</li><li>将磁盘进行分区<br> <code>fdisk /dev/sdb</code> 依次输入<code>n,p,1</code>，最后按<code>w</code>保存退出</li><li>使用<code>fdisk -l</code> 查看，是否出现<code>dev/sdb1</code></li><li>创建物理卷 <code>pvcreate /dev/sdb1</code></li><li>查看VG名称 <code>vgdisplay -v</code></li><li>给<code>root</code>分区所在的卷组扩容，将<code>/dev/sdb1</code>添加到卷组<code>centos</code>上<br> <code>vgextend centos /dev/sdb1</code></li><li>扩展逻辑卷<br> <code>lvextend -L +64G /dev/centos/root</code></li><li>同步文件系统<br> <code>xfs_grow /dev/centos/root</code></li></ol><p><strong>到此为止，两种方法就介绍完了。</strong></p><p>完！</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;在linux系统使用上，可能会遇到No space left的情况，这里说明如何通过压缩&lt;code&gt;home&lt;/code&gt;分区和给添加磁盘给&lt;code&gt;root&lt;/code&gt;目录扩容来解决。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="linux" scheme="http://yoursite.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
    <category term="文件系统" scheme="http://yoursite.com/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>如何定制centOS7系统</title>
    <link href="http://yoursite.com/2020/09/12/%E5%A6%82%E4%BD%95%E5%AE%9A%E5%88%B6centOS7%E7%B3%BB%E7%BB%9F/"/>
    <id>http://yoursite.com/2020/09/12/%E5%A6%82%E4%BD%95%E5%AE%9A%E5%88%B6centOS7%E7%B3%BB%E7%BB%9F/</id>
    <published>2020-09-12T13:39:27.000Z</published>
    <updated>2020-09-12T13:42:22.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>很多情况下，我们需要根据需求定制 centOS 系统。本文介绍如何通过修改xml文件和Packages文件夹来实现对centOS7的软件安装的定制。</p></blockquote><span id="more"></span><h4 id="定位需求"><a href="#定位需求" class="headerlink" title="定位需求"></a>定位需求</h4><p>假如领导给你安排任务，叫你定制一个CentOS7系统，在软件选择界面只能选择特定的软件。在默认软件的左侧只允许有虚拟化服务器，和虚拟化服务器管理系统。右边保持默认即可。如下图所示。</p><p><img src="C:%5CUsers%5Clenovo.DESKTOP-JAA702O%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200912202828002.png" alt="image-20200912202828002"></p><p>明白了需求之后我们就可以修改配置文件定制我们的centOS7系统。</p><h4 id="挂载光盘"><a href="#挂载光盘" class="headerlink" title="挂载光盘"></a>挂载光盘</h4><p><code>mount -o loop *.iso /mnt/cdrom</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /mnt/cdrom</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ls</span> -al</span></span><br><span class="line">drwxrwxrwx. 11 root root    253 9月  11 15:37 .</span><br><span class="line">drwxr-xr-x.  3 root root    152 9月  11 16:17 ..</span><br><span class="line">-rwxrwxrwx.  1 root root     57 9月   4 12:54 .discinfo</span><br><span class="line">drwxrwxrwx.  3 root root     35 9月   4 12:54 EFI</span><br><span class="line">-rwxrwxrwx.  1 root root  18092 9月   4 12:54 GPL</span><br><span class="line">drwxrwxrwx.  3 root root     57 9月   4 15:34 images</span><br><span class="line">drwxrwxrwx.  2 root root    217 9月   4 15:40 isolinux</span><br><span class="line">drwxrwxrwx.  2 root root     43 9月   4 13:17 LiveOS</span><br><span class="line">drwxrwxrwx.  2 root root    148 9月   4 15:40 manual</span><br><span class="line">drwxrwxrwx.  2 root root 282624 9月  11 14:00 Packages</span><br><span class="line">drwxrwxrwx.  3 root root   4096 9月   4 13:21 PackageSec</span><br><span class="line">drwxrwxrwx.  2 root root     84 9月   4 12:54 .post</span><br><span class="line">-rwxrwxrwx.  1 root root     83 9月   4 12:54 .productinfo</span><br><span class="line">drwxr-xr-x.  2 root root   4096 9月  12 21:05 repodata</span><br><span class="line">-rwxrwxrwx.  1 root root   1735 9月   4 12:54 RPM-GPG-KEY-kylin-release</span><br><span class="line">-rwxrwxrwx.  1 root root   3086 9月   4 12:54 TRANS.TBL</span><br><span class="line">-rwxrwxrwx.  1 root root   1062 9月   4 12:54 .treeinfo</span><br></pre></td></tr></table></figure><h4 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p>通过关键字搜索，我们可以知道在repodata文件夹下面的*comps.xml文件控制着软件选择界面。在挂载镜像目录下运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">grep -r <span class="string">&quot;最小安装&quot;</span></span></span><br><span class="line">./repodata/*comps.xml</span><br></pre></td></tr></table></figure><p>于是我们可以发现xml文件里面有我们软件选择界面的所有结构及配置，我们只需要通过添加和裁剪掉部分xml标签就可以实现界面功能的更改，通过阅读我们可以发现*comps.xml文件的主要结构如下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">comps</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">group</span>&gt;</span>  <span class="comment">&lt;!--展示在右侧的可选部分标签为group--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>groupid<span class="tag">&lt;/<span class="name">id</span>&gt;</span>  <span class="comment">&lt;!--group的id--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>groupname<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="comment">&lt;!--group的name--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>group description<span class="tag">&lt;/<span class="name">description</span>&gt;</span>  <span class="comment">&lt;!--gourp的大概描述--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">default</span>&gt;</span>true/false<span class="tag">&lt;/<span class="name">default</span>&gt;</span>  <span class="comment">&lt;!--是否默认安装--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">uservisible</span>&gt;</span>true/false<span class="tag">&lt;/<span class="name">uservisible</span>&gt;</span>  <span class="comment">&lt;!--是否对用户可见--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">packagelist</span>&gt;</span>   <span class="comment">&lt;!--此group对应的所有rpm包--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">packagereq</span> <span class="attr">type</span>=<span class="string">&quot;mandatory/optional/default&quot;</span>&gt;</span>rpm name<span class="tag">&lt;/<span class="name">packagereq</span>&gt;</span>  <span class="comment">&lt;!--rpm报名不包含版本号）--&gt;</span>  </span><br><span class="line">            ...</span><br><span class="line">        <span class="tag">&lt;/<span class="name">packagelist</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;<span class="name">category</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span>&gt;</span>  <span class="comment">&lt;!--展示在左侧的由用户选择部分(必须选一个)我们称为environment--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>environment id<span class="tag">&lt;/<span class="name">id</span>&gt;</span>  <span class="comment">&lt;!--environment的id--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>environment name<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  <span class="comment">&lt;!--environment的name--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>environment description<span class="tag">&lt;/<span class="name">description</span>&gt;</span>  <span class="comment">&lt;!--environment的大概描述--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">grouplist</span>&gt;</span>  <span class="comment">&lt;!--如果选中此environment就默认安装一下group--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupid</span>&gt;</span>groupid<span class="tag">&lt;/<span class="name">groupid</span>&gt;</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="tag">&lt;/<span class="name">grouplist</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optionlist</span>&gt;</span>  <span class="comment">&lt;!--若选中此environment，右侧栏显示下列group--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupid</span>&gt;</span>groupid<span class="tag">&lt;/<span class="name">groupid</span>&gt;</span> <span class="comment">&lt;!--core必须写在里面--&gt;</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="tag">&lt;/<span class="name">optionlist</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">comps</span>&gt;</span></span><br></pre></td></tr></table></figure><p>根据上述信息修改xml文件即可。</p><h4 id="配置依赖包"><a href="#配置依赖包" class="headerlink" title="配置依赖包"></a>配置依赖包</h4><p>上面工作之后我们已经修改好了界面，但是我们修改了界面之后还需要将所选中软件的rpm包添加到光盘中。<br>还是通过关键字搜索：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">find ./ -name <span class="string">&quot;*.rpm&quot;</span></span></span><br><span class="line">./Packages/xxx.rpm</span><br><span class="line">./PackageSec/xxx.rpm</span><br></pre></td></tr></table></figure><p>分别进入两个文件夹里看一下，可以发现软件安装所需要的rpm包都是在Packages里面。事实上PackageSec文件夹负责的是安全部分。后面我们会提到。<br>知道了Packages是负责rpm包之后我们只需要将所有rpm包放进去即可。</p><h4 id="让修改生效"><a href="#让修改生效" class="headerlink" title="让修改生效"></a>让修改生效</h4><p>第一次尝试定制镜像时踩了很多坑，其中就包括让修改后的xml文件生效的问题。修改完之后如果直接制作iso会发现安装时候界面没有任何改动。这时我们就需要createrepo这个命令来实现让修改生效，此命令会重新生成repodata文件夹。<br>我们先将xxx-comps.xml文件移到家目录下，然后删除repodata文件夹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> repodata/xxx-comps.xml ~/xmls/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">rm</span> -rf repodata/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">createrepo -g ~/xmls/xxx.xml ./</span></span><br></pre></td></tr></table></figure><p>这时我们就重新生成了repodata文件，但是我们进行完这一步之后xml文件虽然生效了，但是在软件安装时还是会出现unknown error。<br>这是因为我们的PackageSec文件夹是负责安全部分，贸然的使用createrepo会让负责安全部分的文件和其他文件产生冲突。所以我们应该先将PackageSec文件夹移出去，再重新使用createrepo命令，接着再移进来。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> repodata/xxx-comps.xml ~/xmls/</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">rm</span> -rf repodata/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> PackageSec/ ../</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">createrepo -g ~/xmls/xxx.xml ./</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> ../PackageSec ./</span></span><br></pre></td></tr></table></figure><p>此时修改配置文件完毕。</p><h4 id="重新生成镜像"><a href="#重新生成镜像" class="headerlink" title="重新生成镜像"></a>重新生成镜像</h4><p><code>mkisofs -v -U -J -R -T -m repoview -m boot.iso -b isolinux/isolinux.bin -c isolinux/boot.cat -no-emul-boot -boot-load-size 4 -boot-info-table -eltorito-alt-boot -e images/efiboot.img -no-emul-boot -V 光盘label -o 存放iso目录 镜像挂载文件夹</code></p><p><strong>至此，centOS7软件安装界面定制完成。</strong></p><p>完！</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;很多情况下，我们需要根据需求定制 centOS 系统。本文介绍如何通过修改xml文件和Packages文件夹来实现对centOS7的软件安装的定制。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="linux" scheme="http://yoursite.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
    <category term="centOS7系统定制" scheme="http://yoursite.com/tags/centOS7%E7%B3%BB%E7%BB%9F%E5%AE%9A%E5%88%B6/"/>
    
  </entry>
  
  <entry>
    <title> linux工作区bug解决流程</title>
    <link href="http://yoursite.com/2020/09/04/linux%E5%B7%A5%E4%BD%9C%E5%8C%BAbug%E8%A7%A3%E5%86%B3%E6%B5%81%E7%A8%8B/"/>
    <id>http://yoursite.com/2020/09/04/linux%E5%B7%A5%E4%BD%9C%E5%8C%BAbug%E8%A7%A3%E5%86%B3%E6%B5%81%E7%A8%8B/</id>
    <published>2020-09-04T02:46:36.000Z</published>
    <updated>2020-09-06T14:32:02.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>在kylin10 V10操作系统中存在右键任务栏，显示工作区相关内容的bug，本文介绍如何解决</p></blockquote><span id="more"></span><h4 id="定位问题"><a href="#定位问题" class="headerlink" title="定位问题"></a>定位问题</h4><p>查找rpm包的基本流程在之前的文章中有提到。本篇也算是将理论实践了一番。感兴趣的可以看一下<br>由于任务区存在汉化功能。可以直接在/usr/share/locale中直接查找关键字</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/share/locale</span><br><span class="line">grep -r &quot;仅在此工作区显示&quot;</span><br></pre></td></tr></table></figure><p>然后就可以搜索到相应的汉化.mo文件<br>找到相关文件之后，我们就可以通过rpm命令来找到是哪个rpm包中存在此文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qf /usr/share/locale/XXX (XXX指的是上面查找到的文件名)</span><br></pre></td></tr></table></figure><p>知道了是哪个rpm包支持此功能，我们就可以通过rpm命令找到src源码包名</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qi XXX（XXX指的是上面提到的rpm包名）</span><br></pre></td></tr></table></figure><p>至此，就可以定位到工作区源码包。</p><h4 id="定位并屏蔽源代码"><a href="#定位并屏蔽源代码" class="headerlink" title="定位并屏蔽源代码"></a>定位并屏蔽源代码</h4><p><strong>确定是哪个模块负责工作区，使用关键字进行搜索</strong></p><ul><li>使用grep命令查找关键字</li><li>通过搞清代码结构，可以尝试，但是过于复杂，时间可能不够用</li></ul><p>这里我们采用第一种方法</p><p><code>grep -r &quot;_Only On This Workspace&quot;</code></p><p>可以定位到源码在哪里，由于此bug逻辑比较简单。直接将搜索到的代码模块屏蔽即可</p><h4 id="生成patch重新编译"><a href="#生成patch重新编译" class="headerlink" title="生成patch重新编译"></a>生成patch重新编译</h4><p>制作patch文件<br>通过git format-patch HEAD^生成补丁，patch文件里可以有文件对比的差异。<br>打patch步骤如下：</p><ul><li><p>获取源码，通过rpm ivh xxx.src.rpm，可以在家目录中生成rpmbuild目录，并生成SOURCE及SPEC目录。分别存放.tar包以及.spec文件</p></li><li><p>展开源码包，进入SPEC目录，通过rpmbuild -bp xxx.spec命令，在rpmbuild目录下生成BUILD目录，并解压.tar文件到BUILD目录下获取到源码</p></li><li><p>生成parch文件，使用git format-patch生成patch文件</p></li><li><ul><li>首先在BUILD目录中生成git仓库，使用git init命令</li><li>接下来，追踪本地所有源代码git add –all</li><li>然后，使用git commit -m “提交描述” 将源代码提交到仓库</li><li>下一步，修改源码，自行vim操作，然后git add –all 提交更改，之后git commit -m “修改描述”</li><li>生成patch文件，git format-patch HEAD^</li><li>最后，复制patch文件~/rpmbuild/SOURCE中</li></ul></li><li><p>修改spec文件，将patch文件添加进去。此处为添加patch</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Begin add by XXX</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Patch0:xxx.patch</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">End add by XXX</span></span><br></pre></td></tr></table></figure><ul><li>将补丁打入，其中注意其中的-p1（路径问题，可以网上搜索一下）</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">%patch0 p1 -b .inline-icons</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">%patch0 p1</span></span><br></pre></td></tr></table></figure><ul><li>修改changelog，注意格式问题</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">* Wed Aug 19 2020 warren &lt;weiyuan@kylinos.cn&gt; 2.31.0-1</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">- add patch xxx(尽量详细)</span></span><br></pre></td></tr></table></figure><p>​    完成上述过程后已经对源码进行spec文件修改，相应的Patch文件已经放入SOURCE文件中。可以运行 rpmbuild -bp xxx.spec文件，查看BUILD中源码是否被修改</p><ul><li>rpm -ba xxx.spec 重新编译所有的包</li></ul><h4 id="重新安装"><a href="#重新安装" class="headerlink" title="重新安装"></a>重新安装</h4><p>rpm -e xxx.rpm –nodeps ，不管依赖直接卸载rpm包<br>安装后生成的rpm包，rpm -ivh xxx.rpm<br>重启reboot</p><p>完！</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;在kylin10 V10操作系统中存在右键任务栏，显示工作区相关内容的bug，本文介绍如何解决&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="linux" scheme="http://yoursite.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
    <category term="bug解决流程" scheme="http://yoursite.com/tags/bug%E8%A7%A3%E5%86%B3%E6%B5%81%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title> 搭建ovirt-engine基本流程 </title>
    <link href="http://yoursite.com/2020/09/02/%E6%90%AD%E5%BB%BAovirt-engine%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/"/>
    <id>http://yoursite.com/2020/09/02/%E6%90%AD%E5%BB%BAovirt-engine%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/</id>
    <published>2020-09-02T06:10:42.000Z</published>
    <updated>2020-09-02T08:00:20.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ovirt是红帽虚拟化产品，其中由两部分组成，ovirt-engine及ovirt-node。此文介绍ovirt-engine的安装教程。</p></blockquote><span id="more"></span><h4 id="系统安装"><a href="#系统安装" class="headerlink" title="系统安装"></a>系统安装</h4><p>在VMware上安装CentOS7_64位<br>国内阿里站点：<a href="http://mirrors.aliyun.com/centos/7/isos/x86_64/">http://mirrors.aliyun.com/centos/7/isos/x86_64/</a><br>然后选择<br><img src="images/centos7_64.jpg" alt=""></p><p>在vmware上最小安装或者即可，后面再装上图形界面。因为后面yum update步骤会导致图形界面显示不了  </p><h4 id="系统设置"><a href="#系统设置" class="headerlink" title="系统设置"></a>系统设置</h4><p><strong>为了安装过程一切顺利，先关掉SELinux</strong>  </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/selinux/config</span><br><span class="line">将SELinux对应位置修改为</span><br><span class="line">SELinux=diabled</span><br></pre></td></tr></table></figure><p><strong>然后关掉防火墙</strong></p><p><code>systemctl disable firewalld</code></p><p><strong>设置hostname</strong></p><p>后面设置host结点的时候必须通过Engine所在服务器的FQDN来进行设置。这里手动打上<br><code>hostnamectl set-hostname engine.lian</code></p><p>可以使用hostnamectl查看当前主机名称喝系统信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@engine vdsm]# hostnamectl</span><br><span class="line">   Static hostname: engine.lian</span><br><span class="line">         Icon name: computer-vm</span><br><span class="line">           Chassis: vm</span><br><span class="line">        Machine ID: 607207ea728149ff9c74754bc00bcc88</span><br><span class="line">           Boot ID: 291b316adffd4432aa812ebb4173a60d</span><br><span class="line">    Virtualization: vmware</span><br><span class="line">  Operating System: CentOS Linux 7 (Core)</span><br><span class="line">       CPE OS Name: cpe:/o:centos:centos:7</span><br><span class="line">            Kernel: Linux 3.10.0-1127.19.1.el7.x86_64</span><br><span class="line">      Architecture: x86-64</span><br></pre></td></tr></table></figure><p><strong>然后重启系统</strong></p><p><code>reboot</code></p><h4 id="安装ovirt-engine管理后台"><a href="#安装ovirt-engine管理后台" class="headerlink" title="安装ovirt-engine管理后台"></a>安装ovirt-engine管理后台</h4><p><strong>修改yum源</strong></p><p>centos7官方的yum源连接速度实在太慢，这里改为网易的yum源，需要将原来的源备份一下，防止以后用到</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /etc/yum.repos.d</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mkdir</span> bak</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> *.repo bak/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">curl -o CentOS7-Base-163.repo http://mirrors.163.com/.help/CentOS7-Base-163.repo</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum clean all</span></span><br></pre></td></tr></table></figure><p><strong>在下载ovirt-engine之前，将ovirt官方的源添加到yum源库中</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum -y install http://resources.ovirt.org/pub/yum-repo/ovirt-release43.rpm</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum -y update</span></span><br></pre></td></tr></table></figure><p>yum -y update这一步很重要，时间占用略长，需要耐心等待。否则后面安装 ovirt-engine 时将无法查询到 ovirt-engin的包。<br>这里我们选择4.3是因为，后面安装 ovirt-node 时下载 vdsm  的 4.3以下 版本的会与与SOS有冲突。所以直接下载4.3版本。</p><p><strong>安装ovirt-engine</strong></p><p><code># yum -y install ovirt-enine</code></p><p>这一步由于依赖关系会到ovirt官方源获取。可能连接失败，需要多试几次。经过多次测试，只要将依赖关系下载下来。半小时之内都会下载下来。  </p><p>这一步会安装大量的依赖的包大约351个。占用时间比较长。尤其是最后一个ovirt-engine-*的包需要从ovirt官方的源下载，速度比较慢。需耐心等待。<br>如果在下载完成后出现一下错误。  </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GPG key retrieval failed: [Errno 12] Timeout on https://raw.githubusercontent.com/CentOS-Storage-SIG/centos-release-storage-common/master/RPM-GPG-KEY-CentOS-SIG-Storage: (28,&amp;nbsp;’Connection timed out after 30001 milliseconds’)  </span><br></pre></td></tr></table></figure><p>这是GPG key检测超时，将gpg检测关掉即可  </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/yum.repos.d/ovirt-4.3.repo</span><br><span class="line">vi /etc/yum.repos.d/ovirt-4.3-dependencies.repo</span><br></pre></td></tr></table></figure><p>将gpgcheck设置为0</p><p><code>gpgcheck = 0</code></p><h4 id="配置ovirt-engine"><a href="#配置ovirt-engine" class="headerlink" title="配置ovirt-engine"></a>配置ovirt-engine</h4><p>ovirt-engine安装完成需要运行首次配置向导  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line">[root@engine ~]# engine-setup</span><br><span class="line">[ INFO  ] Stage: Initializing</span><br><span class="line">[ INFO  ] Stage: Environment setup</span><br><span class="line">          Configuration files: [&#x27;/etc/ovirt-engine-setup.conf.d/10-packaging-jboss.conf&#x27;, &#x27;/etc/ovirt-engine-setup.conf.d/10-packaging.conf&#x27;]</span><br><span class="line">          Log file: /var/log/ovirt-engine/setup/ovirt-engine-setup-20200831091209-oo7toy.log</span><br><span class="line">          Version: otopi-1.8.4 (otopi-1.8.4-1.el7)</span><br><span class="line">[ INFO  ] Stage: Environment packages setup</span><br><span class="line">[ INFO  ] Stage: Programs detection</span><br><span class="line">[ INFO  ] Stage: Environment setup (late)</span><br><span class="line">[ INFO  ] Stage: Environment customization</span><br><span class="line">         </span><br><span class="line">          --== PRODUCT OPTIONS ==--</span><br><span class="line">         </span><br><span class="line">          Set up Cinderlib integration</span><br><span class="line">          (Currently in tech preview)</span><br><span class="line">          (Yes, No) [No]: 回车</span><br><span class="line">          Configure Engine on this host (Yes, No) [Yes]: 回车</span><br><span class="line">          Configure ovirt-provider-ovn (Yes, No) [Yes]: 回车(OVN:Open Virtual Network,配置虚拟化网络)</span><br><span class="line">          Configure WebSocket Proxy on this host (Yes, No) [Yes]:回车(WebSocket Proxy用来支持使用noVNC远程登录虚拟机图形界面管理)</span><br><span class="line">          * Please note * : Data Warehouse is required for the engine.</span><br><span class="line">          If you choose to not configure it on this host, you have to configure</span><br><span class="line">          it on a remote host, and then configure the engine on this host so</span><br><span class="line">          that it can access the database of the remote Data Warehouse host.</span><br><span class="line">          Configure Data Warehouse on this host (Yes, No) [Yes]: 回车(在本机配置数据库)</span><br><span class="line">          Configure Image I/O Proxy on this host (Yes, No) [Yes]: 回车(Image I/O Proxy可以支持向oVirt平台中上传虚拟机的磁盘镜像)</span><br><span class="line">          Configure VM Console Proxy on this host (Yes, No) [Yes]: 回车(支持访问虚拟机的串口console通信)</span><br><span class="line">         </span><br><span class="line">          --== PACKAGES ==--</span><br><span class="line">         </span><br><span class="line">[ INFO  ] Checking for product updates...</span><br><span class="line">[ INFO  ] No product updates found</span><br><span class="line">         </span><br><span class="line">          --== NETWORK CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">          Host fully qualified DNS name of this server [engine.lian]: 回车(使用默认hostname就行,反正是准备用IP地址访问无所谓)</span><br><span class="line">[WARNING] Failed to resolve engine.lian using DNS, it can be resolved only locally</span><br><span class="line">          Setup can automatically configure the firewall on this system.</span><br><span class="line">          Note: automatic configuration of the firewall may overwrite current settings.</span><br><span class="line">          NOTICE: iptables is deprecated and will be removed in future releases</span><br><span class="line">          Do you want Setup to configure the firewall? (Yes, No) [Yes]: no回车(因为之前已经把防火墙服务给关掉了,所以就不用再配置防火墙的具体设置了)</span><br><span class="line">         </span><br><span class="line">          --== DATABASE CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">          Where is the DWH database located? (Local, Remote) [Local]: 回车(DWH:Data WareHouse使用本地数据库)</span><br><span class="line">          Setup can configure the local postgresql server automatically for the DWH to run. This may conflict with existing applications.</span><br><span class="line">          Would you like Setup to automatically configure postgresql and create DWH database, or prefer to perform that manually? (Automatic, Manual) [Automatic]: 回车(自动配置PostGreSQL数据库)</span><br><span class="line">          Where is the ovirt cinderlib database located? (Local, Remote) [Local]: </span><br><span class="line">          Setup can configure the local postgresql server automatically for the CinderLib to run. This may conflict with existing applications.</span><br><span class="line">          Would you like Setup to automatically configure postgresql and create CinderLib database, or prefer to perform that manually? (Automatic, Manual) [Automatic]: 回车(自动配置PostGreSQL数据库)</span><br><span class="line">          Where is the Engine database located? (Local, Remote) [Local]: 回车(Engine用到的数据库位于本机)</span><br><span class="line">          Setup can configure the local postgresql server automatically for the engine to run. This may conflict with existing applications.</span><br><span class="line">          Would you like Setup to automatically configure postgresql and create Engine database, or prefer to perform that manually? (Automatic, Manual) [Automatic]: 回车(使用安装程序自动创建Engine数据库)</span><br><span class="line">         </span><br><span class="line">          --== OVIRT ENGINE CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">          Engine admin password: 输入后台管理员密码回车</span><br><span class="line">          Confirm engine admin password: 再次输入密码回车</span><br><span class="line">[WARNING] Password is weak: The password is shorter than 8 characters</span><br><span class="line">          Use weak password? (Yes, No) [No]: yes（密码太弱才会有的选项，如果有输入yes回车）</span><br><span class="line">          Application mode (Virt, Gluster, Both) [Both]: 回车</span><br><span class="line">         </span><br><span class="line">          --== STORAGE CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">          Default SAN wipe after delete (Yes, No) [No]: 回车(yes的话在删除虚拟机的虚拟磁盘后会擦除存储设备上的对应块)</span><br><span class="line">         </span><br><span class="line">          --== PKI CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">          Organization name for certificate [lian]: 回车</span><br><span class="line">         </span><br><span class="line">          --== APACHE CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">          Setup can configure the default page of the web server to present the application home page. This may conflict with existing applications.</span><br><span class="line">          Do you wish to set the application as the default page of the web server? (Yes, No) [Yes]: 回车(使用apache作为web服务器)</span><br><span class="line">          Setup can configure apache to use SSL using a certificate issued from the internal CA.</span><br><span class="line">          Do you wish Setup to configure that, or prefer to perform that manually? (Automatic, Manual) [Automatic]: 回车(自动配置CA证书)</span><br><span class="line">         </span><br><span class="line">          --== SYSTEM CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">         </span><br><span class="line">          --== MISC CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">          Please choose Data Warehouse sampling scale:</span><br><span class="line">          (1) Basic</span><br><span class="line">          (2) Full</span><br><span class="line">          (1, 2)[1]: 回车(使用基本的数据库示例初始化数据)</span><br><span class="line">         </span><br><span class="line">          --== END OF CONFIGURATION ==--</span><br><span class="line">         </span><br><span class="line">[ INFO  ] Stage: Setup validation</span><br><span class="line">[WARNING] Warning: Not enough memory is available on the host. Minimum requirement is 4096MB, and 16384MB is recommended.</span><br><span class="line">          Do you want Setup to continue, with amount of memory less than recommended? (Yes, No) [No]: yes回车(因为在虚拟机上装，内存过小才会有的提示。我们要输入yes)</span><br><span class="line">         </span><br><span class="line">          --== CONFIGURATION PREVIEW ==--</span><br><span class="line">         </span><br><span class="line">          Application mode                        : both</span><br><span class="line">          Default SAN wipe after delete           : False</span><br><span class="line">          Update Firewall                         : False</span><br><span class="line">          Host FQDN                               : engine.lian</span><br><span class="line">          CinderLib database secured connection   : False</span><br><span class="line">          CinderLib database user name            : ovirt_cinderlib</span><br><span class="line">          CinderLib database name                 : ovirt_cinderlib</span><br><span class="line">          CinderLib database host                 : localhost</span><br><span class="line">          CinderLib database port                 : 5432</span><br><span class="line">          CinderLib database host name validation : False</span><br><span class="line">          Set up Cinderlib integration            : True</span><br><span class="line">          Configure local CinderLib database      : True</span><br><span class="line">          Configure local Engine database         : True</span><br><span class="line">          Set application as default page         : True</span><br><span class="line">          Configure Apache SSL                    : True</span><br><span class="line">          Engine database secured connection      : False</span><br><span class="line">          Engine database user name               : engine</span><br><span class="line">          Engine database name                    : engine</span><br><span class="line">          Engine database host                    : localhost</span><br><span class="line">          Engine database port                    : 5432</span><br><span class="line">          Engine database host name validation    : False</span><br><span class="line">          Engine installation                     : True</span><br><span class="line">          PKI organization                        : lian</span><br><span class="line">          Set up ovirt-provider-ovn               : False</span><br><span class="line">          Configure WebSocket Proxy               : True</span><br><span class="line">          DWH installation                        : True</span><br><span class="line">          DWH database host                       : localhost</span><br><span class="line">          DWH database port                       : 5432</span><br><span class="line">          Configure local DWH database            : True</span><br><span class="line">          Configure Image I/O Proxy               : True</span><br><span class="line">          Configure VMConsole Proxy               : True</span><br><span class="line">         </span><br><span class="line">          Please confirm installation settings (OK, Cancel) [OK]: 回车</span><br><span class="line">[ INFO  ] Stage: Transaction setup</span><br><span class="line">[ INFO  ] Stopping engine service</span><br><span class="line">[ INFO  ] Stopping ovirt-fence-kdump-listener service</span><br><span class="line">[ INFO  ] Stopping dwh service</span><br><span class="line">[ INFO  ] Stopping Image I/O Proxy service</span><br><span class="line">[ INFO  ] Stopping vmconsole-proxy service</span><br><span class="line">[ INFO  ] Stopping websocket-proxy service</span><br><span class="line">[ INFO  ] Stage: Misc configuration (early)</span><br><span class="line">[ INFO  ] Stage: Package installation</span><br><span class="line">[ INFO  ] Stage: Misc configuration</span><br><span class="line">[ INFO  ] Initializing PostgreSQL</span><br><span class="line">[ INFO  ] Creating PostgreSQL &#x27;ovirt_cinderlib&#x27; database</span><br><span class="line">[ INFO  ] Configuring PostgreSQL</span><br><span class="line">[ INFO  ] Upgrading CA</span><br><span class="line">[ INFO  ] Creating PostgreSQL &#x27;engine&#x27; database</span><br><span class="line">[ INFO  ] Configuring PostgreSQL</span><br><span class="line">[ INFO  ] Creating PostgreSQL &#x27;ovirt_engine_history&#x27; database</span><br><span class="line">[ INFO  ] Configuring PostgreSQL</span><br><span class="line">[ INFO  ] Creating CA</span><br><span class="line">[ INFO  ] Creating/refreshing DWH database schema</span><br><span class="line">[ INFO  ] Configuring Image I/O Proxy</span><br><span class="line">[ INFO  ] Setting up ovirt-vmconsole proxy helper PKI artifacts</span><br><span class="line">[ INFO  ] Setting up ovirt-vmconsole SSH PKI artifacts</span><br><span class="line">[ INFO  ] Configuring WebSocket Proxy</span><br><span class="line">[ INFO  ] Creating/refreshing Engine database schema</span><br><span class="line">[ INFO  ] Creating/refreshing Engine &#x27;internal&#x27; domain database schema</span><br><span class="line">[ INFO  ] Creating default mac pool range</span><br><span class="line">[ INFO  ] Setting a password for internal user admin</span><br><span class="line">[ INFO  ] Generating post install configuration file &#x27;/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf&#x27;</span><br><span class="line">[ INFO  ] Stage: Transaction commit</span><br><span class="line">[ INFO  ] Stage: Closing up</span><br><span class="line">[ INFO  ] Starting engine service</span><br><span class="line">[ INFO  ] Starting dwh service</span><br><span class="line">[ INFO  ] Restarting ovirt-vmconsole proxy service</span><br><span class="line">         </span><br><span class="line">          --== SUMMARY ==--</span><br><span class="line">         </span><br><span class="line">[ INFO  ] Restarting httpd</span><br><span class="line">          In order to configure firewalld, copy the files from</span><br><span class="line">              /etc/ovirt-engine/firewalld to /etc/firewalld/services</span><br><span class="line">              and execute the following commands:</span><br><span class="line">              firewall-cmd --permanent --add-service ovirt-postgres</span><br><span class="line">              firewall-cmd --permanent --add-service ovirt-https</span><br><span class="line">              firewall-cmd --permanent --add-service ovirt-fence-kdump-listener</span><br><span class="line">              firewall-cmd --permanent --add-service ovirt-imageio-proxy</span><br><span class="line">              firewall-cmd --permanent --add-service ovirt-websocket-proxy</span><br><span class="line">              firewall-cmd --permanent --add-service ovirt-http</span><br><span class="line">              firewall-cmd --permanent --add-service ovirt-vmconsole-proxy</span><br><span class="line">              firewall-cmd --reload</span><br><span class="line">          The following network ports should be opened:</span><br><span class="line">              tcp:2222</span><br><span class="line">              tcp:443</span><br><span class="line">              tcp:5432</span><br><span class="line">              tcp:54323</span><br><span class="line">              tcp:6100</span><br><span class="line">              tcp:80</span><br><span class="line">              udp:7410</span><br><span class="line">          An example of the required configuration for iptables can be found at:</span><br><span class="line">              /etc/ovirt-engine/iptables.example</span><br><span class="line">          Please use the user &#x27;admin@internal&#x27; and password specified in order to login</span><br><span class="line">          Web access is enabled at:</span><br><span class="line">              http://engine.lian:80/ovirt-engine</span><br><span class="line">              https://engine.lian:443/ovirt-engine</span><br><span class="line">          Internal CA C3:CE:5F:1C:AB:52:AC:0A:F5:AA:D1:A2:86:5A:3D:25:CC:CF:81:7E</span><br><span class="line">          SSH fingerprint: SHA256:fyQ+cLuByiqbFG6f/I/Ukid4yv3IwzrYJFUX0MpiwCg</span><br><span class="line">[WARNING] Warning: Not enough memory is available on the host. Minimum requirement is 4096MB, and 16384MB is recommended.</span><br><span class="line">         </span><br><span class="line">          --== END OF SUMMARY ==--</span><br><span class="line">         </span><br><span class="line">[ INFO  ] Stage: Clean up</span><br><span class="line">          Log file is located at /var/log/ovirt-engine/setup/ovirt-engine-setup-20200831091209-oo7toy.log</span><br><span class="line">[ INFO  ] Generating answer file &#x27;/var/lib/ovirt-engine/setup/answers/20200831092223-setup.conf&#x27;</span><br><span class="line">[ INFO  ] Stage: Pre-termination</span><br><span class="line">[ INFO  ] Stage: Termination</span><br><span class="line">[ INFO  ] Execution of setup completed successfully</span><br></pre></td></tr></table></figure><p>至此，在本机上安装ovirt完毕，但是如果在另一台电脑上访问服务器ip地址，会提示<br>“The FQDN used to access the system is not a valid engine FQDN. You must access the system using the engine FQDN or one of the engine alternate FQDNs.”</p><p><img src="images/ovirt-engine.png" alt=""></p><p><strong>想要让其他电脑可以正常访问服务器ip，需要修改配置文件配置文件</strong></p><p><code>vim /etc/ovirt-engine/engine.conf.d/*-sso.conf</code></p><p>写入内容</p><p><code>SSO_CALLBACK_PREFIX_CHECK=false</code></p><p>然后重启 ovirt-engine服务</p><p><code>service ovir-engine restart</code></p><p>再次访问，错误提示消失，至此，搭建完成。</p><p><img src="images/ovirt%E4%B8%BB%E9%A1%B5.png" alt=""></p><p>完！</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ovirt是红帽虚拟化产品，其中由两部分组成，ovirt-engine及ovirt-node。此文介绍ovirt-engine的安装教程。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="linux" scheme="http://yoursite.com/categories/linux/"/>
    
    
    <category term="ovirt" scheme="http://yoursite.com/tags/ovirt/"/>
    
    <category term="虚拟化" scheme="http://yoursite.com/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>rpm查找源码包的基本流程</title>
    <link href="http://yoursite.com/2020/08/21/rpm%E6%9F%A5%E6%89%BE%E6%BA%90%E7%A0%81%E5%8C%85%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/"/>
    <id>http://yoursite.com/2020/08/21/rpm%E6%9F%A5%E6%89%BE%E6%BA%90%E7%A0%81%E5%8C%85%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/</id>
    <published>2020-08-21T07:46:23.000Z</published>
    <updated>2020-08-21T07:47:44.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>linux系统修复Bug时通常需要找到rpm源码包进行修改，本文主要介绍如何进行源码包的匹配。</p></blockquote><span id="more"></span><h4 id="查找源码包流程"><a href="#查找源码包流程" class="headerlink" title="查找源码包流程"></a>查找源码包流程</h4><h5 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a>第一种方法</h5><p><strong>通过进程名称查找</strong></p><p>先用top找到相关的进程名，可以后面使用-接参数，可灵活使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure><p>找到对应的进程名称之后通过rpm -qa搜索进程名，可以出现部分rpm包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep 进程名称</span><br></pre></td></tr></table></figure><p>可以匹配出几个rpm安装包，使用这种方法可能匹配出来的包较多，所以不能够确定具体时哪个包<br>所以不太确定  </p><h5 id="第二种方法"><a href="#第二种方法" class="headerlink" title="第二种方法"></a>第二种方法</h5><p><strong>通过汉化包查找</strong></p><p>首先进入到 /usr/share/locale目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/share/locale</span><br></pre></td></tr></table></figure><p>然后再在此目录内匹配搜索相关信息，例如:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -r &quot;发送到桌面快捷方式&quot;</span><br></pre></td></tr></table></figure><p>基本可以确定是哪个文件里面有这个汉化包<br>然后根据上面搜索到的文件路径，使用rpm -qf匹配时哪个安装包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qf &quot;/usr/share/locale/上面查找到文件的路径&quot;</span><br></pre></td></tr></table></figure><p>确定安装包的名称</p><p>然后根据匹配到的安装包名通过 rpm -qi 找到源码包名字</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qi 安装包名称</span><br></pre></td></tr></table></figure><p>找到源码包之后下载源码包，找到相应的源码修改即可</p><p><strong>可将两种方法结合起来灵活使用为佳</strong></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;linux系统修复Bug时通常需要找到rpm源码包进行修改，本文主要介绍如何进行源码包的匹配。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="linux" scheme="http://yoursite.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
    <category term="rpm 编包" scheme="http://yoursite.com/tags/rpm-%E7%BC%96%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>go语言 make和new的区别</title>
    <link href="http://yoursite.com/2019/12/22/go%E8%AF%AD%E8%A8%80-make%E5%92%8Cnew%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>http://yoursite.com/2019/12/22/go%E8%AF%AD%E8%A8%80-make%E5%92%8Cnew%E7%9A%84%E5%8C%BA%E5%88%AB/</id>
    <published>2019-12-22T07:08:49.000Z</published>
    <updated>2019-12-22T07:20:10.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>new和make都可以用来分配空间，初始化类型，但是他们确有不同</p></blockquote><span id="more"></span><h4 id="new-int-返回的是将T初始化零值之后T类型的指针"><a href="#new-int-返回的是将T初始化零值之后T类型的指针" class="headerlink" title="new(int)返回的是将T初始化零值之后T类型的指针"></a>new(int)返回的是将T初始化零值之后T类型的指针</h4><p>new(T)分配一个T类型的空间并初始化为T类型的零值，返回T类型变量的指针<br>例如  </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p := <span class="built_in">new</span>(<span class="type">int</span>)</span><br></pre></td></tr></table></figure><p>上面代码中p和下面的代码第三行的p是等价的  </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p *<span class="type">int</span></span><br><span class="line">i := <span class="number">0</span></span><br><span class="line">p = &amp;i</span><br></pre></td></tr></table></figure><p>new(int)将分配的空间初始化为int的零值即为0，并返回int的指针  </p><h4 id="make只能用于slice-map-channel"><a href="#make只能用于slice-map-channel" class="headerlink" title="make只能用于slice,map,channel"></a>make只能用于slice,map,channel</h4><p>make只能用于slice，map，channel三种类型，make(T,args)返回的是初始化之后T类型的值，这个值是经过初始化之后T的引用，而不是指针*T，也不是T类型的零值  </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s []<span class="type">int</span></span><br><span class="line"><span class="keyword">if</span> s == <span class="literal">nil</span>&#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;s is nil ---&gt;%v\n&quot;</span>,s) <span class="comment">// []int(nil)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述代码表示slice的零值是nil</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s := <span class="built_in">make</span>([]<span class="type">int</span>,<span class="number">3</span>)</span><br><span class="line"><span class="keyword">if</span> s == <span class="literal">nil</span>&#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;s is nil---&gt;%v\n&quot;</span>,s)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;s is not nil ---&gt;%v\n&quot;</span>,s) <span class="comment">// []int&#123;0,0,0&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用make之后的slice是一个初始化的slice，即slice的长度，宽度，底层指向的array都被make完成初始化，此时slice内容被Int的零值填充，形式是[0,0,0]，map和channel也是类似的。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c1 <span class="keyword">chan</span> <span class="type">string</span></span><br><span class="line"><span class="keyword">if</span> c1 == <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;c1 is nil --&gt; %#v \n &quot;</span>, c1) <span class="comment">//(chan string)(nil)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c2 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>)</span><br><span class="line"><span class="keyword">if</span> c2 == <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;c2 is nil --&gt; %#v \n &quot;</span>, c2)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;c2 is not nill --&gt; %#v \n &quot;</span>, c2)<span class="comment">//(chan string)(0xc420016120)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="make-T-args-返回的是T的引用"><a href="#make-T-args-返回的是T的引用" class="headerlink" title="make(T,args)返回的是T的引用"></a>make(T,args)返回的是T的引用</h5><p>如果不特殊声明，go的函数默认都是按值传参。在函数内部对值修改不影响值本身，但是make(T,args)通过函数传递参数之后可以直接修改，即map，slice，channel通过参数之后在函数内部修改将直接影响到外部的值</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">modifySlice</span><span class="params">(s []<span class="type">int</span>)</span></span>&#123;</span><br><span class="line">s[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">s := <span class="built_in">make</span>([]<span class="type">int</span>,<span class="number">3</span>)</span><br><span class="line">fmt.Println(s) <span class="comment">// []int&#123;0,0,0&#125;</span></span><br><span class="line">modifySlice(s)</span><br><span class="line">fmt.Println(s) <span class="comment">// []int&#123;1,0,0&#125;</span></span><br></pre></td></tr></table></figure><p>这说明make()返回的是引用类型，在函数内可以直接更改s的原始值，对map和channel也是如此</p><h4 id="很少使用new"><a href="#很少使用new" class="headerlink" title="很少使用new()"></a>很少使用new()</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Foo <span class="keyword">struct</span>&#123;</span><br><span class="line">    name <span class="type">string</span></span><br><span class="line">    age <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 声明初始化</span></span><br><span class="line"><span class="keyword">var</span> foo1 Foo</span><br><span class="line">fmt.Printf(<span class="string">&quot;foo1 ---&gt;%v\n&quot;</span>,foo1) <span class="comment">// main.Foo&#123;age:0,name:&quot;&quot;&#125;</span></span><br><span class="line">foo1.age = <span class="number">1</span></span><br><span class="line">fmt.Println(fool.age)</span><br><span class="line"></span><br><span class="line"><span class="comment">// struct literal 初始化</span></span><br><span class="line">foo2 := Foo&#123;&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;foo1 ---&gt;%v\n&quot;</span>,foo2) <span class="comment">// main.Foo&#123;age:0,name:&quot;&quot;&#125;</span></span><br><span class="line">foo2.age = <span class="number">2</span></span><br><span class="line">fmt.Println(foo2.age)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指针初始化</span></span><br><span class="line">foo3 := &amp;Foo&#123;&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;foo1 ---&gt;%v\n&quot;</span>,foo3) <span class="comment">// main.Foo&#123;age:0,name:&quot;&quot;&#125;</span></span><br><span class="line">foo2.age = <span class="number">3</span></span><br><span class="line">fmt.Println(foo2.age)</span><br><span class="line"></span><br><span class="line"><span class="comment">// new 初始化</span></span><br><span class="line">foo4 := <span class="built_in">new</span>(Foo)</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明指针并用 new 初始化</span></span><br><span class="line"><span class="keyword">var</span> foo5 *Foo = <span class="built_in">new</span>(Foo)</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>foo1 和foo2都是类型的值，foo3/4/5都是Foo的指针类型。但是所有的foo都可以直接使用Foo的field，读取或者修改，为什么？  </p><p>因为go会自动进行转换。foo1.age和foo3.age是等价的。  </p><p>因而可以直接使用struct literal的方式创建对象，能达到和new创建一样的情况而不需要使用new()，这个也是随个人习惯。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;new和make都可以用来分配空间，初始化类型，但是他们确有不同&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="golang" scheme="http://yoursite.com/categories/golang/"/>
    
    
    <category term="golang" scheme="http://yoursite.com/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>理解pandas中axis</title>
    <link href="http://yoursite.com/2019/12/22/%E7%90%86%E8%A7%A3pandas%E4%B8%ADaxis/"/>
    <id>http://yoursite.com/2019/12/22/%E7%90%86%E8%A7%A3pandas%E4%B8%ADaxis/</id>
    <published>2019-12-22T06:52:42.000Z</published>
    <updated>2019-12-22T07:48:04.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>不管是在pandas还是在numpy中，axis作为一个参数都是一个很重要的存在。但有时我们会纠结于axis到底是作用于行还是列中。这里我们就来理解axis到底是如何定义的。</p></blockquote><span id="more"></span><p>python中的axis到底是如何定义的。为0/1时是代表行还是列？<br>我们用以下代码做示例    </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df=pd.DataFrame(np.random.rand(<span class="number">12</span>).reshape(<span class="number">4</span>,-<span class="number">1</span>),index=<span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>),columns=<span class="built_in">list</span>(<span class="string">&#x27;ABC&#x27;</span>))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">out:</span></span><br><span class="line"><span class="string">          A         B         C</span></span><br><span class="line"><span class="string">a  0.931192  0.306019  0.990724</span></span><br><span class="line"><span class="string">b  0.342723  0.174033  0.799012</span></span><br><span class="line"><span class="string">c  0.809201  0.566531  0.135429</span></span><br><span class="line"><span class="string">d  0.068132  0.739093  0.610740</span></span><br><span class="line"><span class="string">out end;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>这里我们先创建了一个DataFrame，现在使用drop方法丢弃掉其中一列，使用axis为1的情况  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df.drop(<span class="string">&#x27;A&#x27;</span>,axis=<span class="number">1</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">out:</span></span><br><span class="line"><span class="string">          B         C</span></span><br><span class="line"><span class="string">a  0.306019  0.990724</span></span><br><span class="line"><span class="string">b  0.174033  0.799012</span></span><br><span class="line"><span class="string">c  0.566531  0.135429</span></span><br><span class="line"><span class="string">d  0.739093  0.610740</span></span><br><span class="line"><span class="string">out end;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>可以看到A列已经被删除了，在这里axis作用于列。    </p><p>现在我们调用mean(1)求均值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df.mean(axis=<span class="number">1</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">out:</span></span><br><span class="line"><span class="string">a    0.742645</span></span><br><span class="line"><span class="string">b    0.438589</span></span><br><span class="line"><span class="string">c    0.503720</span></span><br><span class="line"><span class="string">d    0.472655</span></span><br><span class="line"><span class="string">dtype: float64</span></span><br><span class="line"><span class="string">out end;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>对于上面的例子来说，当axis为1时却求出了每一行的均值。  </p><blockquote><p>现在我们来看一下官方帮助的解释：</p></blockquote><p><strong>轴用来为超过一维的数组定义的属性，二维数组拥有两个轴，第0轴沿着行垂直往下。第一轴沿着列的水平方向延申</strong></p><p>用图片来解释就是下图。浅显易懂</p><p><img src="images/%E7%9F%A9%E9%98%B5%E8%BD%B4.png" alt=""></p><p><strong>注意官方使用纵轴和横轴和来解释0和1，而轴是有方向的。所以不要用行和列的思维去解释行和列。因为行和列是没有方向的</strong><br>有了上面的理解之后，我们就可以解释为什么mean(1)时求出的是每一行的平均值了<br>其实是沿着从左到右的方向（也就是上面我们提到的横轴）求出平均值，并不是我们所误解的每一行求平均值。<br> 作用在drop()上时，也是横向发生变化，体现在列的值减少</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;不管是在pandas还是在numpy中，axis作为一个参数都是一个很重要的存在。但有时我们会纠结于axis到底是作用于行还是列中。这里我们就来理解axis到底是如何定义的。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    <category term="pandas" scheme="http://yoursite.com/categories/python/pandas/"/>
    
    
    <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
    <category term="pandas" scheme="http://yoursite.com/tags/pandas/"/>
    
  </entry>
  
  <entry>
    <title>numpy.random中常用模块</title>
    <link href="http://yoursite.com/2019/12/22/numpy-random%E4%B8%AD%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/"/>
    <id>http://yoursite.com/2019/12/22/numpy-random%E4%B8%AD%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/</id>
    <published>2019-12-22T06:41:35.000Z</published>
    <updated>2019-12-22T07:07:36.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>numpy是我们在python中常用的用于数据分析的工具，在numpy里面又存在很多节省时间的方法，例如random模块，这个可以产生随机值的模块。在很大程度上可以帮我们产生需要的一系列值。</p></blockquote><span id="more"></span><p>numpy.random常用模块<br><strong>rand(4,3)函数返回0-1之间的数字</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">array([[<span class="number">0.3832652</span> , <span class="number">0.36343273</span>, <span class="number">0.47900132</span>],</span><br><span class="line">       [<span class="number">0.62420466</span>, <span class="number">0.13228593</span>, <span class="number">0.58927964</span>],</span><br><span class="line">       [<span class="number">0.36499423</span>, <span class="number">0.18262211</span>, <span class="number">0.59475821</span>],</span><br><span class="line">       [<span class="number">0.31715646</span>, <span class="number">0.11298201</span>, <span class="number">0.36332277</span>]])</span><br></pre></td></tr></table></figure><p>*<em>randn(4,3)返回一个或者一组样本，符合正态分布 *</em>  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">array([[ <span class="number">0.27580105</span>, -<span class="number">0.79606409</span>,  <span class="number">0.27770072</span>],</span><br><span class="line">       [-<span class="number">0.41272231</span>,  <span class="number">1.1971399</span> ,  <span class="number">1.144409</span>  ],</span><br><span class="line">       [ <span class="number">0.84481791</span>, -<span class="number">1.18783243</span>,  <span class="number">0.92623515</span>],</span><br><span class="line">np       [ <span class="number">1.45964641</span>, -<span class="number">0.39872575</span>,  <span class="number">0.38672823</span>]])</span><br></pre></td></tr></table></figure><p><strong>randint(low,high=None,size=None,dtype=</strong>)</p><p>返回随机整数，范围区间为[low,high]，包含Low不包含high<br>size表示数组维度类型，dtype表示数据类型，默认为np.int<br>high值没有填写时，生成的数据是0-low，不包含low  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: np.random.randint(<span class="number">1</span>,<span class="number">4</span>,size=(<span class="number">2</span>,<span class="number">2</span>))</span><br><span class="line">Out[<span class="number">1</span>]:</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">1</span>, <span class="number">2</span>]])</span><br></pre></td></tr></table></figure><p><strong>生成[0,1)之间的浮点数</strong></p><ul><li>numpy.random.random_sample(size=None)</li><li>numpy.random.random(size=None)</li><li>numpy.random.ranf(s/ize=None)</li><li>numpy.random.sample(size=None)</li></ul><p>size表示维度</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">2</span>]: np.random.random_sample(size=[<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">Out[<span class="number">2</span>]:</span><br><span class="line">array([[<span class="number">0.645753</span>  , <span class="number">0.31327233</span>],</span><br><span class="line">       [<span class="number">0.75382147</span>, <span class="number">0.63840037</span>]])</span><br></pre></td></tr></table></figure><p><strong>numpy.random.choice</strong>()</p><p>numpy.random.choice(a,size=None,replace=True,p=None)</p><ul><li>从给定的一维数组中生成随机数</li><li>a为一维数组或者整数，sizes为数组维度，p为数组中数据出现的概率</li><li>如果a是一个整数，对应的一维数组是arange(a)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">3</span>]: np.random.choice(<span class="number">4</span>,size=[<span class="number">2</span>,<span class="number">4</span>])</span><br><span class="line">Out[<span class="number">3</span>]:</span><br><span class="line">array([[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>]])</span><br></pre></td></tr></table></figure><ul><li>当replace是，生成的数据不能有重复值，这就要求数组的长度大于size  </li><li>参数p的长度必须等于数组的长度，且p里面数据之和应该等于0</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">20</span>]: np.random.choice(demo_list,size=(<span class="number">3</span>,<span class="number">3</span>),p=(<span class="number">0.1</span>,<span class="number">0.6</span>,<span class="number">0.1</span>,<span class="number">0.1</span>,<span class="number">0.1</span>))</span><br><span class="line">Out[<span class="number">20</span>]:</span><br><span class="line">array([[<span class="string">&#x27;sansumg&#x27;</span>, <span class="string">&#x27;lenovo&#x27;</span>, <span class="string">&#x27;iphone&#x27;</span>],</span><br><span class="line">       [<span class="string">&#x27;moto&#x27;</span>, <span class="string">&#x27;sansumg&#x27;</span>, <span class="string">&#x27;xiaomi&#x27;</span>],</span><br><span class="line">       [<span class="string">&#x27;sansumg&#x27;</span>, <span class="string">&#x27;sansumg&#x27;</span>, <span class="string">&#x27;sansumg&#x27;</span>]], dtype=<span class="string">&#x27;&lt;U7&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>np.random.seed()</strong></p><ul><li>np.random.seed()的作用，使得随机数据可预测</li><li>当我们设置相同的seed，每次生成的随机数相同。如果不设置seed，则每次会生成不同的随机数</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">44</span>]: np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">45</span>]: np.random.rand(<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">Out[<span class="number">45</span>]:</span><br><span class="line">array([[<span class="number">4.17022005e-01</span>, <span class="number">7.20324493e-01</span>, <span class="number">1.14374817e-04</span>],</span><br><span class="line">       [<span class="number">3.02332573e-01</span>, <span class="number">1.46755891e-01</span>, <span class="number">9.23385948e-02</span>],</span><br><span class="line">       [<span class="number">1.86260211e-01</span>, <span class="number">3.45560727e-01</span>, <span class="number">3.96767474e-01</span>],</span><br><span class="line">       [<span class="number">5.38816734e-01</span>, <span class="number">4.19194514e-01</span>, <span class="number">6.85219500e-01</span>]])</span><br><span class="line"></span><br><span class="line">In [<span class="number">46</span>]: np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">47</span>]: np.random.rand(<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">Out[<span class="number">47</span>]:</span><br><span class="line">array([[<span class="number">4.17022005e-01</span>, <span class="number">7.20324493e-01</span>, <span class="number">1.14374817e-04</span>],</span><br><span class="line">       [<span class="number">3.02332573e-01</span>, <span class="number">1.46755891e-01</span>, <span class="number">9.23385948e-02</span>],</span><br><span class="line">       [<span class="number">1.86260211e-01</span>, <span class="number">3.45560727e-01</span>, <span class="number">3.96767474e-01</span>],</span><br><span class="line">       [<span class="number">5.38816734e-01</span>, <span class="number">4.19194514e-01</span>, <span class="number">6.85219500e-01</span>]])</span><br></pre></td></tr></table></figure><hr><p>这里穿插一个np.arange()，这也是常用到的函数  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">np.arange(-<span class="number">1</span>,<span class="number">1</span>,<span class="number">0.1</span>)</span><br><span class="line">array([-<span class="number">1.00000000e+00</span>, -<span class="number">9.00000000e-01</span>, -<span class="number">8.00000000e-01</span>, -<span class="number">7.00000000e-01</span>,</span><br><span class="line">       -<span class="number">6.00000000e-01</span>, -<span class="number">5.00000000e-01</span>, -<span class="number">4.00000000e-01</span>, -<span class="number">3.00000000e-01</span>,</span><br><span class="line">       -<span class="number">2.00000000e-01</span>, -<span class="number">1.00000000e-01</span>, -<span class="number">2.22044605e-16</span>,  <span class="number">1.00000000e-01</span>,</span><br><span class="line">        <span class="number">2.00000000e-01</span>,  <span class="number">3.00000000e-01</span>,  <span class="number">4.00000000e-01</span>,  <span class="number">5.00000000e-01</span>,</span><br><span class="line">        <span class="number">6.00000000e-01</span>,  <span class="number">7.00000000e-01</span>,  <span class="number">8.00000000e-01</span>,  <span class="number">9.00000000e-01</span>])</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;numpy是我们在python中常用的用于数据分析的工具，在numpy里面又存在很多节省时间的方法，例如random模块，这个可以产生随机值的模块。在很大程度上可以帮我们产生需要的一系列值。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    <category term="numpy" scheme="http://yoursite.com/categories/python/numpy/"/>
    
    
    <category term="numpy" scheme="http://yoursite.com/tags/numpy/"/>
    
    <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>二分查找算法</title>
    <link href="http://yoursite.com/2019/12/22/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"/>
    <id>http://yoursite.com/2019/12/22/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/</id>
    <published>2019-12-22T06:35:57.000Z</published>
    <updated>2019-12-22T07:07:44.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>查找算法是经常用到的算法之一，在很多情况下，我们都需要实现适合需求的查找算法。今天我们来实现排序算法中比较经典的二分查找，并探讨其时间复杂度。</p></blockquote><span id="more"></span><h4 id="数据结构与算法"><a href="#数据结构与算法" class="headerlink" title="数据结构与算法"></a>数据结构与算法</h4><p>二分查找要求数组已经是有序的，在有序的基础上进行二分查找。关于数组排序的问题可以参考我之前的博客。</p><h5 id="二分查找："><a href="#二分查找：" class="headerlink" title="二分查找："></a>二分查找：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">binary_search</span>(<span class="params"><span class="built_in">list</span>,item</span>):</span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="built_in">len</span>(<span class="built_in">list</span>)-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid = <span class="built_in">int</span>((low+high)/<span class="number">2</span>)</span><br><span class="line">        guess = <span class="built_in">list</span>[mid]</span><br><span class="line">        <span class="keyword">if</span> guess==item:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">        <span class="keyword">if</span> guess&gt;item:</span><br><span class="line">            high = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            low = mid + <span class="number">1</span> <span class="comment"># 防止进入无限循环</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><p>用大O表示法的话，二分查找的时间复杂度为O(log n)（log表示以2为底数），因为对于一个长度为n的数组，利用二分查找方法查找一个元素最多需要使用log n（以2为底数）次数。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;查找算法是经常用到的算法之一，在很多情况下，我们都需要实现适合需求的查找算法。今天我们来实现排序算法中比较经典的二分查找，并探讨其时间复杂度。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="算法" scheme="http://yoursite.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
    <category term="查找" scheme="http://yoursite.com/tags/%E6%9F%A5%E6%89%BE/"/>
    
  </entry>
  
  <entry>
    <title>用python实现排序算法</title>
    <link href="http://yoursite.com/2019/12/16/%E7%94%A8python%E5%AE%9E%E7%8E%B0%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
    <id>http://yoursite.com/2019/12/16/%E7%94%A8python%E5%AE%9E%E7%8E%B0%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</id>
    <published>2019-12-16T12:25:31.000Z</published>
    <updated>2019-12-16T12:32:36.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>排序在很多种情况下都会用到，尽管python有自带的sort排序。但是很多时候我们还是要根据实际情况采取最适合的排序方法。这里我们用python来实现8大排序中的5个常见的排序。其余三个以后再更新。</p></blockquote><span id="more"></span><h4 id="用Python实现8大排序"><a href="#用Python实现8大排序" class="headerlink" title="用Python实现8大排序"></a>用Python实现8大排序</h4><h5 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">maopao_sort</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    length = <span class="built_in">len</span>(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        ischanged = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(length-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> a[j] &gt; a[j+<span class="number">1</span>]:</span><br><span class="line">                a[j],a[j+<span class="number">1</span>] = a[j+<span class="number">1</span>],a[j]</span><br><span class="line">                ischanged = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> ischanged==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br></pre></td></tr></table></figure><h5 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">xuanze_sort</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    length = <span class="built_in">len</span>(a)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        k = find_min(a[j:])</span><br><span class="line">        a[j],a[k+j] = a[k+j],a[j]</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_min</span>(<span class="params">a</span>):</span><br><span class="line">    m = a[<span class="number">0</span>]</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> a[i]&lt;m:</span><br><span class="line">            m = a[i]</span><br><span class="line">            k = i</span><br><span class="line">    <span class="keyword">return</span> k</span><br></pre></td></tr></table></figure><h5 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">insert_sort</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    length = <span class="built_in">len</span>(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,i):</span><br><span class="line">            <span class="keyword">if</span> a[j]&gt;a[i]:</span><br><span class="line">                m = a[i]</span><br><span class="line">                a[j+<span class="number">1</span>:i+<span class="number">1</span>] = a[j:i]</span><br><span class="line">                a[j] = m</span><br><span class="line">    <span class="keyword">return</span> a</span><br></pre></td></tr></table></figure><h5 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">quick_sort</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    m = a[<span class="number">0</span>]</span><br><span class="line">    a.pop(<span class="number">0</span>)</span><br><span class="line">    left = [i <span class="keyword">for</span> i <span class="keyword">in</span> a <span class="keyword">if</span> i&lt;=m]</span><br><span class="line">    right = [i <span class="keyword">for</span> i <span class="keyword">in</span> a <span class="keyword">if</span> i&gt;m]</span><br><span class="line">    <span class="keyword">return</span> quick_sort(left) + [m] + quick_sort(right)</span><br></pre></td></tr></table></figure><h5 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge_sort</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    half = <span class="built_in">int</span>(<span class="built_in">len</span>(a)/<span class="number">2</span>)</span><br><span class="line">    left = merge_sort(a[:half])</span><br><span class="line">    right = merge_sort(a[half:])</span><br><span class="line">    <span class="keyword">return</span> merge(left,right)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">left,right</span>):</span><br><span class="line">    result = []</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(left) <span class="keyword">and</span> j &lt; <span class="built_in">len</span>(right):</span><br><span class="line">        <span class="keyword">if</span> left[i] &lt;= right[j]:</span><br><span class="line">            result.append(left[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(right[j])</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">    result.extend(left[i:])</span><br><span class="line">    result.extend(right[j:])</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;排序在很多种情况下都会用到，尽管python有自带的sort排序。但是很多时候我们还是要根据实际情况采取最适合的排序方法。这里我们用python来实现8大排序中的5个常见的排序。其余三个以后再更新。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="数据结构" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    <category term="python" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/python/"/>
    
    
    <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
    <category term="排序" scheme="http://yoursite.com/tags/%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>numpy中transpose,T,swapaxes 方法</title>
    <link href="http://yoursite.com/2019/12/08/numpy%E4%B8%ADtranspose%EF%BC%8CT%EF%BC%8C-swapaxes-%E6%96%B9%E6%B3%95/"/>
    <id>http://yoursite.com/2019/12/08/numpy%E4%B8%ADtranspose%EF%BC%8CT%EF%BC%8C-swapaxes-%E6%96%B9%E6%B3%95/</id>
    <published>2019-12-08T11:58:13.000Z</published>
    <updated>2019-12-08T12:04:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>搞懂 numpy 置换方法transpose，T， swapaxes  </p><p><strong>transpose函数</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">0</span>]: arr = np.arange(<span class="number">16</span>).reshape(<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">In [<span class="number">1</span>]: arr</span><br><span class="line">Out[<span class="number">1</span>]: </span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">        [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]]])</span><br><span class="line">In [<span class="number">2</span>]: arr.transpose(<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">Out[<span class="number">2</span>]:</span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">4</span>],</span><br><span class="line">        [ <span class="number">8</span>, <span class="number">12</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">1</span>,  <span class="number">5</span>],</span><br><span class="line">        [ <span class="number">9</span>, <span class="number">13</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">2</span>,  <span class="number">6</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">14</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">3</span>,  <span class="number">7</span>],</span><br><span class="line">        [<span class="number">11</span>, <span class="number">15</span>]]])</span><br></pre></td></tr></table></figure><span id="more"></span><p>怎么理解呢？？首先我们要搞清楚transpose里面的参数(2，0，1)代表的是什么。<br>我们知道在pandas里面0，1代表的是DataFrame里的横轴和纵轴。在Numpy中一个array可能不止有两阶，那怎么用数字表示呢？<br>在这方面pandas和numpy采用了同样的设计，都是直接用(0,1,2,3,4，…)，代表每一阶的轴<br>所以现在我们应该应该豁然开朗了(0,1,2)代表的就是每一级的轴。<br>知道了这个之后，我们再来看tanspose的运算方式：<br>以1为例在arr里坐标是（0，0，1），用（2，0，1）进行置换  </p><ul><li>2在（2，0，1）置换方式的第一个数，而2代表第三阶。代表把第原来第三阶坐标放到第一阶</li><li>0代表把原来第一阶坐标放到第二阶</li><li>1代表把原来第二阶坐标放到第三阶</li></ul><p>得到的结果就是（1，0，0），以此类推，就得到了上面的结果。</p><p><strong>T</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">12</span>]: arr</span><br><span class="line">Out[<span class="number">12</span>]:</span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">        [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]]])</span><br><span class="line">In [<span class="number">2</span>]: arr.T      </span><br><span class="line">Out[<span class="number">2</span>]:            </span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">8</span>],  </span><br><span class="line">        [ <span class="number">4</span>, <span class="number">12</span>]], </span><br><span class="line">                   </span><br><span class="line">       [[ <span class="number">1</span>,  <span class="number">9</span>],  </span><br><span class="line">        [ <span class="number">5</span>, <span class="number">13</span>]], </span><br><span class="line">                   </span><br><span class="line">       [[ <span class="number">2</span>, <span class="number">10</span>],  </span><br><span class="line">        [ <span class="number">6</span>, <span class="number">14</span>]], </span><br><span class="line">                   </span><br><span class="line">       [[ <span class="number">3</span>, <span class="number">11</span>],  </span><br><span class="line">        [ <span class="number">7</span>, <span class="number">15</span>]]])</span><br></pre></td></tr></table></figure><p>这里我们来探讨一下他的转置原理<br>*<em>以数字10为例，在arr中的坐标为（1，0，2），在arr.T中的坐标是（2，0，1）。 *</em><br>看到这里你应该有些明白了，就是单纯的把坐标换颠倒而已，把每个元素的坐标都置换过来，就形成了一个arr.T ，也就是arr.T和arr.transpose(2,1,0)得到的是同一个结果<br>arr.T的shape变成了（4，2，2）</p><p><strong>swapaxes</strong></p><p>先上代码示范  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">34</span>]: arr</span><br><span class="line">Out[<span class="number">34</span>]:</span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">        [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]]])</span><br><span class="line">In [<span class="number">35</span>]: arr.swapaxes(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">Out[<span class="number">35</span>]:</span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">4</span>],</span><br><span class="line">        [ <span class="number">1</span>,  <span class="number">5</span>],</span><br><span class="line">        [ <span class="number">2</span>,  <span class="number">6</span>],</span><br><span class="line">        [ <span class="number">3</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>, <span class="number">12</span>],</span><br><span class="line">        [ <span class="number">9</span>, <span class="number">13</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">14</span>],</span><br><span class="line">        [<span class="number">11</span>, <span class="number">15</span>]]])</span><br><span class="line"></span><br><span class="line">In [<span class="number">36</span>]: arr.swapaxes(<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">Out[<span class="number">36</span>]:</span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">4</span>],</span><br><span class="line">        [ <span class="number">1</span>,  <span class="number">5</span>],</span><br><span class="line">        [ <span class="number">2</span>,  <span class="number">6</span>],</span><br><span class="line">        [ <span class="number">3</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>, <span class="number">12</span>],</span><br><span class="line">        [ <span class="number">9</span>, <span class="number">13</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">14</span>],</span><br><span class="line">        [<span class="number">11</span>, <span class="number">15</span>]]])    </span><br></pre></td></tr></table></figure><p>其实在知道了上面两种置换方法之后，swapaxes( )就没有那么神秘了<br>其实就是简单地把两个轴置的坐标对调一下，同样的结果也可以通过arr.transpose(0,2,1)来实现，不信我们来试验一下  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">37</span>]: arr.transpose(<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">Out[<span class="number">37</span>]:</span><br><span class="line">array([[[ <span class="number">0</span>,  <span class="number">4</span>],</span><br><span class="line">        [ <span class="number">1</span>,  <span class="number">5</span>],</span><br><span class="line">        [ <span class="number">2</span>,  <span class="number">6</span>],</span><br><span class="line">        [ <span class="number">3</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>, <span class="number">12</span>],</span><br><span class="line">        [ <span class="number">9</span>, <span class="number">13</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">14</span>],</span><br><span class="line">        [<span class="number">11</span>, <span class="number">15</span>]]])</span><br></pre></td></tr></table></figure><p>实践是检验真理的唯一标准，只要认真做一遍，其实也没有那么玄乎啦！</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;搞懂 numpy 置换方法transpose，T， swapaxes  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;transpose函数&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]: arr = np.arange(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;).reshape(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]: arr&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;array([[[ &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [ &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       [[ &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;]]])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]: arr.transpose(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;array([[[ &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [ &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       [[ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [ &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       [[ &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       [[ &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,  &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;]]])&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="numpy" scheme="http://yoursite.com/categories/numpy/"/>
    
    
    <category term="numpy" scheme="http://yoursite.com/tags/numpy/"/>
    
    <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>前言</title>
    <link href="http://yoursite.com/2019/12/07/hello-world/"/>
    <id>http://yoursite.com/2019/12/07/hello-world/</id>
    <published>2019-12-07T11:58:13.000Z</published>
    <updated>2025-12-15T01:41:26.403Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>静以修身，俭以养德</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;静以修身，俭以养德&lt;/p&gt;
&lt;/blockquote&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>numpy average与mean区别</title>
    <link href="http://yoursite.com/2019/12/04/numpy%20average%E4%B8%8Emean%E5%8C%BA%E5%88%AB,/"/>
    <id>http://yoursite.com/2019/12/04/numpy%20average%E4%B8%8Emean%E5%8C%BA%E5%88%AB,/</id>
    <published>2019-12-04T14:44:02.000Z</published>
    <updated>2019-12-22T07:07:32.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>average和mean都表示均值，但是两个函数却是各有侧重点。这就要求我们在特定的情况下调用最适合的函数。这里我们就来讲一下这连个容易混淆的方法。</p></blockquote><span id="more"></span><p><strong>numpy average与mean区别</strong><br>这里看几个小例子</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">5</span>]: df = pd.DataFrame(&#123;<span class="string">&#x27;data1&#x27;</span>:np.random.randn(<span class="number">8</span>),<span class="string">&#x27;data2&#x27;</span>:np.random.randn(<span class="number">8</span>)&#125;)</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: df</span><br><span class="line">Out[<span class="number">6</span>]:</span><br><span class="line">      data1     data2</span><br><span class="line"><span class="number">0</span> -<span class="number">0.904163</span>  <span class="number">1.266769</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.349836</span>  <span class="number">0.372943</span></span><br><span class="line"><span class="number">2</span> -<span class="number">0.140213</span> -<span class="number">1.850433</span></span><br><span class="line"><span class="number">3</span>  <span class="number">0.159576</span> -<span class="number">0.712505</span></span><br><span class="line"><span class="number">4</span> -<span class="number">0.133263</span> -<span class="number">0.710342</span></span><br><span class="line"><span class="number">5</span> -<span class="number">0.426558</span>  <span class="number">2.569380</span></span><br><span class="line"><span class="number">6</span> -<span class="number">0.478641</span> -<span class="number">0.912875</span></span><br><span class="line"><span class="number">7</span> -<span class="number">0.159328</span>  <span class="number">0.988578</span></span><br></pre></td></tr></table></figure><p>在不传入axis的情况下，对df分别进行average()与mean()运算</p><!--more--><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [10]: np.average(df)</span><br><span class="line">Out[10]: -0.04507746461893059</span><br><span class="line">In [12]: np.mean(df)</span><br><span class="line">Out[12]:</span><br><span class="line">data1   -0.216594</span><br><span class="line">data2    0.126439</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><p>可见np.average方法是对整体取平均值，而np.mean()是默认axis=0的情况下求平均值<br>且两个函数返回的数据类型不同，np.average()返回array数组，而np.mean()返回的是Series类型</p><p>在传入axis为0情况下，对df分别进行average()与mean()运算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">11</span>]: np.average(df,<span class="number">0</span>)</span><br><span class="line">Out[<span class="number">11</span>]: array([-<span class="number">0.</span>In [<span class="number">13</span>]: np.mean(df,<span class="number">0</span>)</span><br><span class="line">In [<span class="number">13</span>]: np.mean(df,<span class="number">0</span>)</span><br><span class="line">Out[<span class="number">13</span>]:</span><br><span class="line">data1   -<span class="number">0.216594</span></span><br><span class="line">data2    <span class="number">0.126439</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可见，两个函数返回数据一样，但类型不一样</p><blockquote><p>在axis等于1的情况下，结果与上例相似，在此不举例</p></blockquote><p>除此之外<strong>average还可以计算加权平均值</strong></p><p>什么是加权品均值，这里举个例子</p><p>a = [1,2,3,4,5]，b=[2,3,4,5,6]</p><p>以b为权重取a的加权平均值结果就是</p><p>1*2 + 2*3 + 3*4 + 4*5 + 5*6/2 + 3 + 4 + 5 + 6</p><p>所以这里还是举上面的df为例，取以data2为权重data1的加权平均值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">17</span>]: np.average(df[<span class="string">&#x27;data1&#x27;</span>],weights=df[<span class="string">&#x27;data2&#x27;</span>])</span><br><span class="line">Out[<span class="number">17</span>]: -<span class="number">1.572923774192011</span></span><br></pre></td></tr></table></figure><p>得出结果</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;average和mean都表示均值，但是两个函数却是各有侧重点。这就要求我们在特定的情况下调用最适合的函数。这里我们就来讲一下这连个容易混淆的方法。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    <category term="numpy" scheme="http://yoursite.com/categories/python/numpy/"/>
    
    
    <category term="numpy" scheme="http://yoursite.com/tags/numpy/"/>
    
    <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
    <category term="数据分析" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>numpy中meshgrid函数</title>
    <link href="http://yoursite.com/2019/12/04/numpy%E4%B8%ADmeshgrid%E5%87%BD%E6%95%B0/"/>
    <id>http://yoursite.com/2019/12/04/numpy%E4%B8%ADmeshgrid%E5%87%BD%E6%95%B0/</id>
    <published>2019-12-04T14:44:02.000Z</published>
    <updated>2019-12-16T12:31:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>numpy中meshgrid函数</p><p>先来看官方文档：<br> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html">https://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html</a><br>功能：从一个坐标向量中返回一个坐标矩阵<br>参数：  </p><ul><li>x1，x2，x3：一维的数组代表网格的坐标</li><li>indexing：{‘xy’,’ij’}，笛卡尔坐标’xy’或者矩阵’ij’下标作为输出，默认是笛卡尔坐标</li><li>sparse：bool类型，如果是True，返回一个稀疏矩阵保存在内存中，默认为False</li><li>copy： bool类型，如果是False，返回一个原始数组的视图保存在内存中，默认是True。如果，sparse和copy都为False，将有可能返回一个不连续的数组。而且，如果广播数组的元素超过一个，可以使用一个独立的内存。如果想要对这个数组进行写操作，请先拷贝这个数组。 </li></ul><p>看完官方文档之后还是一脸懵逼？？？？直接上例子解释</p><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: nx,ny = (<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">In [<span class="number">4</span>]: x = np.linspace(<span class="number">1</span>,<span class="number">2</span>,nx) <span class="comment"># [1,1.5,2]</span></span><br><span class="line">In [<span class="number">6</span>]: y = np.linspace(<span class="number">1</span>,<span class="number">2</span>,ny) <span class="comment"># [1,2]</span></span><br><span class="line">In [<span class="number">7</span>]: xv,yv = np.meshgrid(x,y)</span><br><span class="line">In [<span class="number">10</span>]: xv</span><br><span class="line">Out[<span class="number">10</span>]:</span><br><span class="line">array([[<span class="number">1.</span> , <span class="number">1.5</span>, <span class="number">2.</span> ],</span><br><span class="line">       [<span class="number">1.</span> , <span class="number">1.5</span>, <span class="number">2.</span> ]])</span><br><span class="line">In [<span class="number">11</span>]: yv</span><br><span class="line">Out[<span class="number">11</span>]:</span><br><span class="line">array([[<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">       [<span class="number">2.</span>, <span class="number">2.</span>, <span class="number">2.</span>]])       </span><br></pre></td></tr></table></figure><p>上面的例子可以看出是将两个输入的数组进行拓展，前一个拓展与后一个有关，后一个拓展与前一个有关。前一个是竖轴拓展，后一个是横轴拓展。  </p><p>因为 y 的长度为2，所以 x 竖向被拓展成原来的两倍。同理，y被拓展成横向的三倍 ，输入由原来的数组变成了矩阵，下面我们来看一下表格矩阵的坐标：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: xv.ravel()</span><br><span class="line">Out[<span class="number">1</span>]:</span><br><span class="line">array([<span class="number">1.</span>,<span class="number">1.5</span>,<span class="number">2.</span>,<span class="number">1.</span>,<span class="number">1.5</span>,<span class="number">2.</span>])</span><br><span class="line">In [<span class="number">2</span>]: yv.ravel()</span><br><span class="line">Out[<span class="number">2</span>]:</span><br><span class="line">array([<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">2.</span>, <span class="number">2.</span>, <span class="number">2.</span>])</span><br></pre></td></tr></table></figure><p>ravel函数的作用是将矩阵变成一个一维的数组，其中xv.ravel()表示x轴的坐标，yv.ravel()表示y轴的坐标，我们将x轴与y轴的坐标一一对应，就形成了一个网格的坐标  </p><p>如果将sparse参数设置为True，就不会向上面一样拓展了，它产生的网格不是所有的坐标，只有网格对角线上的坐标。  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: xv,yv = np.meshgrid(x,y,sparse=<span class="literal">True</span>)</span><br><span class="line">In [<span class="number">2</span>]: xv</span><br><span class="line">Out[<span class="number">2</span>]:</span><br><span class="line">array([[<span class="number">1.</span> , <span class="number">1.5</span>, <span class="number">2.</span> ]])</span><br><span class="line">In [<span class="number">3</span>]: yv</span><br><span class="line">Out[<span class="number">3</span>]:</span><br><span class="line">array([[<span class="number">1.</span>],</span><br><span class="line">       [<span class="number">2.</span>]])</span><br></pre></td></tr></table></figure><p>补充，这里的数组参数也可以是3个，相应的会产生3个矩阵。实践出真知，最好还是实践一下</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;numpy中meshgrid函数&lt;/p&gt;
&lt;p&gt;先来看官方文档：&lt;br&gt; &lt;a href=&quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html&quot;&gt;https://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html&lt;/a&gt;&lt;br&gt;功能：从一个坐标向量中返回一个坐标矩阵&lt;br&gt;参数：  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;x1，x2，x3：一维的数组代表网格的坐标&lt;/li&gt;
&lt;li&gt;indexing：{‘xy’,’ij’}，笛卡尔坐标’xy’或者矩阵’ij’下标作为输出，默认是笛卡尔坐标&lt;/li&gt;
&lt;li&gt;sparse：bool类型，如果是True，返回一个稀疏矩阵保存在内存中，默认为False&lt;/li&gt;
&lt;li&gt;copy： bool类型，如果是False，返回一个原始数组的视图保存在内存中，默认是True。如果，sparse和copy都为False，将有可能返回一个不连续的数组。而且，如果广播数组的元素超过一个，可以使用一个独立的内存。如果想要对这个数组进行写操作，请先拷贝这个数组。 &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;看完官方文档之后还是一脸懵逼？？？？直接上例子解释&lt;/p&gt;</summary>
    
    
    
    <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    <category term="numpy" scheme="http://yoursite.com/categories/python/numpy/"/>
    
    
    <category term="numpy" scheme="http://yoursite.com/tags/numpy/"/>
    
    <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
    <category term="数据分析" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
</feed>
